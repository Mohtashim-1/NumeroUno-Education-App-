{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-04-16 18:31:02.629812",
 "css": ".col-1{\n      width: 50%; float: left; font-weight: bold;\n      }\n.col-2{\nwidth: 50%; float: right; font-weight: bold;}\t\np{ font-size: 12px; }\n\ntable, th, td {\n  border: 1px solid black;\n}\n  ",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Student Group",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{%- from \"templates/print_formats/standard_macros.html\" import add_header -%}\n\n{# You can keep this if you want, but not needed now #}\n{% set g = {} %}\n\n<div>\n  {% if doc.students %}\n\n    {% set selected_customer = doc.custom_customer or doc.customer %}\n\n    {% set customers = [] %}\n    {% if selected_customer %}\n      {% set customers = [selected_customer] %}\n    {% else %}\n      {% for i in doc.students %}\n        {% if i.customer_name and i.customer_name not in customers %}\n          {% set _ = customers.append(i.customer_name) %}\n        {% endif %}\n      {% endfor %}\n    {% endif %}\n\n    {%- set start = frappe.utils.getdate(doc.custom_from_date or doc.from_date) -%}\n    {%- set end = frappe.utils.getdate(doc.custom_to_date or doc.to_date) -%}\n    {%- set total_days = frappe.utils.date_diff(end, start) + 1 -%}\n    {%- set dates = [] -%}\n    {%- for i in range(total_days) -%}\n      {%- set dt = frappe.utils.add_days(start, i) -%}\n      {%- set _ = dates.append(dt) -%}\n    {%- endfor -%}\n\n    {% for customer in customers %}\n      {% set title = customer if customer else \"&nbsp;\" %}\n\n      {% set po_list = [] %}\n      {% for k in doc.students if k.customer_name == customer %}\n        {% set student_po = frappe.db.get_value(\"Student\", k.student, \"custom_customer_purchase_order\") %}\n        {% if student_po and student_po not in po_list %}\n          {% set _ = po_list.append(student_po) %}\n        {% endif %}\n      {% endfor %}\n\n      {% if po_list|length == 0 %}\n        {% set po_list = [None] %}\n      {% endif %}\n\n      {% for po in po_list %}\n\n        {% set secondary_hits = [] %}\n        {% for k in doc.students if k.customer_name == customer %}\n          {% set student_po = frappe.db.get_value(\"Student\", k.student, \"custom_customer_purchase_order\") %}\n          {% if student_po == po %}\n            {% set sc = frappe.db.get_value(\"Student\", k.student, \"custom_secondary_customer\") %}\n            {% if sc %}\n              {% set _ = secondary_hits.append(1) %}\n            {% endif %}\n          {% endif %}\n        {% endfor %}\n        {% set show_secondary = secondary_hits|length > 0 %}\n\n        <div style=\"page-break-before: always;\">\n\n          {# PAGE HEADER (per PO / per page) #}\n          {% set letter_head = frappe.get_doc(\"Letter Head\", \"Letter Head New\") %}\n          {% if letter_head %}\n            <div class=\"letter-head\">{{ letter_head.content }}</div>\n          {% endif %}\n          <div class=\"row\" style=\"text-align:center; margin-top:0;\">\n            <h2><b><u>ATTENDENCE SHEET</u></b></h2>\n          </div>\n          <div style=\"margin-top:2%; display:flex; gap:24px;\">\n            <div class=\"col-1\">\n              <p><b>Sheet No :</b> {{ doc.name }}</p>\n              <p><b>Date :</b> {{ frappe.utils.formatdate(doc.creation) }}</p>\n              <p><b>Course Start Date :</b> {{ frappe.utils.formatdate(doc.from_date) }}</p>\n              <p><b>Course End Date :</b> {{ frappe.utils.formatdate(doc.to_date) }}</p>\n            </div>\n            <div class=\"col-2\">\n              <p><b>Confirmation Type :</b> {{ po or \"\" }}</p>\n              <p><b>Training :</b> {{ doc.course }}</p>\n              <p><b>Course Location :</b> {{ doc.custom_course_location_name }}</p>\n            </div>\n          </div>\n\n\n<table width=\"100%\" style=\"margin-top: 12px; border: none !important; border-collapse: collapse;\">\n  <tr style=\"border: none !important;\">\n    <td style=\"\n        text-align: left;\n        padding: 0;\n        border: none !important;\n    \">\n      <span style=\"font-size: 16px; font-weight: 800;\">\n        {{ title }}\n      </span>\n\n      {% if po %}\n        <span style=\"font-size: 16px; font-weight: 800;\">\n          \u2014 PO: {{ po }}\n        </span>\n      {% endif %}\n    </td>\n  </tr>\n</table>\n\n\n\n\n\n          <table width=\"100%\" style=\"border:1px solid #000; border-collapse:collapse; margin-top:5%;\">\n            <tr>\n              <th style=\"border:1px solid #000; padding:4px;\">S.No</th>\n              <th style=\"border:1px solid #000; padding:4px;\">Name Of the Delegate</th>\n              <th style=\"border:1px solid #000; padding:4px;\">PO No</th>\n\n              {% if show_secondary %}\n                <th style=\"border:1px solid #000; padding:4px;\">Secondary Company</th>\n              {% endif %}\n\n              <th style=\"border:1px solid #000; padding:4px;\">Nationality</th>\n              <th style=\"border:1px solid #000; padding:4px;\">DOB</th>\n\n              {% for d in dates %}\n                <th style=\"border:1px solid #000; padding:4px; white-space:nowrap;\">\n                  {{ frappe.utils.formatdate(d, \"MMM dd\") }}\n                </th>\n              {% endfor %}\n\n              <th style=\"border:1px solid #000; padding:4px;\">Result</th>\n              <th style=\"border:1px solid #000; padding:4px;\">Card Received</th>\n            </tr>\n\n            {% set serial = [] %}\n\n            {% for k in doc.students if k.customer_name == customer %}\n              {% set student_po = frappe.db.get_value(\"Student\", k.student, \"custom_customer_purchase_order\") %}\n\n              {% if (po and student_po == po) or (not po and not student_po) %}\n                {% set _ = serial.append(1) %}\n                <tr>\n                  <td style=\"border:1px solid #000; padding:4px; text-align:center;\">{{ serial|length }}</td>\n                  <td style=\"border:1px solid #000; padding:4px;\">{{ k.student_name }}</td>\n                  <td style=\"border:1px solid #000; padding:4px;\">{{ student_po or \"\" }}</td>\n\n                  {% if show_secondary %}\n                    {% set secondary_customer = frappe.db.get_value(\"Student\", k.student, \"custom_secondary_customer\") %}\n                    <td style=\"border:1px solid #000; padding:4px;\">{{ secondary_customer or \"\" }}</td>\n                  {% endif %}\n\n                  {% set nationality = frappe.db.get_value(\"Student\", k.student, \"nationality\") %}\n                  <td style=\"border:1px solid #000; padding:4px;\">{{ nationality or \"\" }}</td>\n\n                  {% set dob = frappe.db.get_value(\"Student\", k.student, \"date_of_birth\") %}\n                  <td style=\"border:1px solid #000; padding:4px;\">{{ frappe.utils.formatdate(dob) if dob else \"\" }}</td>\n\n                  {% for d in dates %}\n                    {% set att_name = frappe.db.get_value(\n                      \"Student Attendance\",\n                      {\"date\": d, \"student_group\": doc.name, \"student\": k.student, \"docstatus\": 1},\n                      \"name\"\n                    ) %}\n                    {% set sig1 = None %}\n                    {% set sig2 = None %}\n                    {% if att_name %}\n                      {% set sig1 = frappe.db.get_value(\"Student Attendance\", att_name, \"custom_student_signature1\") %}\n                      {% set sig2 = frappe.db.get_value(\"Student Attendance\", att_name, \"custom_student_signature\") %}\n                    {% endif %}\n                    <td style=\"border:1px solid #000; padding:4px; text-align:center;\">\n                      {% if sig1 %}\n                        <img src=\"{{ sig1 }}\" style=\"width:60px; height:25px; object-fit:contain;\" />\n                      {% elif sig2 %}\n                        <img src=\"{{ sig2 }}\" style=\"width:60px; height:25px; object-fit:contain;\" />\n                      {% endif %}\n                    </td>\n                  {% endfor %}\n\n                  <td style=\"border:1px solid #000; padding:4px;\"></td>\n\n                  {% set sig = None %}\n                  {% set s_card_name = frappe.db.get_value(\n                    \"Student Card\",\n                    {\"student_group\": doc.name, \"student\": k.student, \"docstatus\": 1},\n                    \"name\"\n                  ) %}\n                  {% if s_card_name %}\n                    {% set sig = frappe.db.get_value(\"Student Card\", s_card_name, \"student_signature\") %}\n                  {% endif %}\n                  <td style=\"border:1px solid #000; padding:4px;\">\n                    {% if sig %}\n                      <img style=\"width:300px; height:70px;\" src=\"{{ sig }}\" />\n                    {% endif %}\n                  </td>\n                </tr>\n              {% endif %}\n            {% endfor %}\n          </table>\n\n          <div style=\"width:100%; overflow:auto;\">\n            <div style=\"float:left; margin-top:5%; width:50%;\">\n              {% if doc.instructors %}\n                {% for i in doc.instructors %}\n                  <p>INSTRUCTOR'S NAME: <b>{{ i.instructor_name }}</b></p>\n                {% endfor %}\n              {% endif %}\n<p>Date: {{ frappe.utils.formatdate(doc.to_date, \"dd-MM-yyyy\") }}</p>\n            </div>\n           {# ---- Get first instructor row safely ---- #}\n{% set row = (doc.instructors[0] if doc.instructors and doc.instructors|length > 0 else None) %}\n\n{% if row and row.instructor %}\n\n  {# ---- Load the linked Instructor document ---- #}\n  {% set inst = frappe.get_doc(\"Instructor\", row.instructor) %}\n\n  {# ---- Put your actual image fieldname here ---- #}\n  {% set img = inst.signature_image or inst.image or inst.photo %}\n\n  {% if img %}\n    {# If stored as /files/... or full URL, this will make it absolute #}\n    {% set img_url = frappe.utils.get_url(img) %}\n\n    <div style=\"float:right; margin-top:5%; width:30%; text-align:right;\">\n      <img src=\"{{ img_url }}\" style=\"width:120px; height:70px; object-fit:contain;\" alt=\"Instructor Signature\"><br>\n      <p style=\"margin:4px 0 0; font-weight:600;\">SIGNATURE:</p>\n    </div>\n  {% endif %}\n\n{% endif %}\n\n            </div>\n          </div>\n        </div>\n      {% endfor %}\n    {% endfor %}\n\n  {% endif %}\n</div>\n\n<footer class=\"print-footer\">\n  <div class=\"col-md-12\">\n    <div class=\"row\">\n      <div id=\"footer-html\" class=\"hidden-pdf\">\n        <div class=\"letter-head-footer\">\n          <table width=\"100%\">\n            <tr>\n              <th>\n                Po Box 132435, ICAD, Behind Dalma Mall Block B Mussaffah, Abu Dhabi, U.A.E\n              </th>\n            </tr>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</footer>\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-12-15 13:48:34.826421",
 "modified_by": "Administrator",
 "module": "Numerouno",
 "name": "NumeroUno Attendance Sheet",
 "owner": "Administrator",
 "page_number": "Hide",
 "pdf_generator": "wkhtmltopdf",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}