{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-07-14 03:13:43.229798",
 "css": ".print-format {\r\n    font-size: 12px;\r\n    background: solid white;\r\n}\r\n\r\n.print-format .first-page-footer {\r\n    margin-top: 100%;\r\n    color:red;\r\n}\r\n\r\n.print-heading {\r\n    border-bottom: 1px solid black;\r\n    font-weight: 400;\r\n    padding: 1px;\r\n    margin-bottom: 2px;\r\n    margin-top: 1px;\r\n    color:black;\r\n}\r\n\r\n.print-heading h2 {\r\n    font-size: 20px;\r\n    }\r\n\r\n.print-heading h2 div {\r\n    font-weight: 400;\r\n    padding-bottom: 1px;\r\n    margin-bottom: 2px;\r\n    margin-top: 2px;\r\n    color: black;\r\n}\r\n\r\n.print-heading h2 br{\r\n    display:none;\r\n}\r\n\r\n.print-heading small {\r\n    font-size: 13px !important;\r\n    font-weight: normal;\r\n    line-height: 1;\r\n    color: black;\r\n    margin-top: 1px;\r\n}\r\n\r\n.print-format .letter-head {\r\n    margin-bottom: 1px;\r\n}\r\n\r\n.print-format label {\r\n    font-weight: 600;\r\n    font-size: 12px;\r\n     /*color: #821f17; */\r\n    line-height: 1;\r\n    margin-bottom: 0;\r\n}\r\n\r\n.print-format .data-field {\r\n    margin-top: 0;\r\n    margin-bottom: 0;\r\n}\r\n\r\n.print-format .value {\r\n    color: black;\r\n    line-height: 1.2;\r\n}\r\n\r\n.print-format .row:not(.section-break) {\r\n    line-height: 1;\r\n    margin-top: 6px !important;\r\n    margin-bottom: 6px !important;\r\n    color:black;\r\n}\r\n\r\n.print-format .important .value {\r\n    font-size: 13px;\r\n    font-weight: 600;\r\n    \r\n}\r\n\r\n.print-format th {\r\n    border:1px solid black;\r\n     /*color: #e3e3e3; */\r\n    /*background-color: #821f17;*/\r\n    /* background-color: #808080; */\r\n    text-transform: uppercase;\r\n    font-weight: 600;\r\n    font-size: 10px !important;\r\n    text-align: center;\r\n}\r\n\r\n.print-format .table-bordered td, .print-format .table-bordered th {\r\n    border: 1px solid black;\r\n    \r\n}\r\n\r\n.print-format .table-bordered {\r\n    vertical-align: middle !important;\r\n    border: 1px solid black;\r\n\r\n}\r\n\r\n.print-format td, .print-format th {\r\n    vertical-align: middle !important;\r\n    font-size: 10px !important;\r\n    padding: 2px !important;\r\n}\r\n.text-container {\r\n    position: relative;\r\n    height: 100%;\r\n}\r\n\r\n    .bottom-paragraph {\r\n        position: fixed;\r\n        bottom: 0;\r\n        left: 0;\r\n        right: 0;\r\n        text-align: center;\r\n        background-color: #f2f2f2;\r\n        padding: 10px;\r\n    }\r\n\r\n.no-page-break{\r\n    page-break-inside:avoid;\r\n}\r\n\r\n.page-break{\r\n    page-break-before:always;\r\n}\r\n.page-number-container {\r\n    position: absolute;\r\n    bottom: 10px; \r\n    right: 10px; \r\n}\r\n\r\n\r\n",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Sales Invoice",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{%- from \"templates/print_formats/standard_macros.html\" import add_header -%}\n\n<style>\n.page-break {\n    page-break-before: always;\n}\n.no-page-break {\n    page-break-inside: avoid;\n}\n</style>\n\n<!-- ========================================== -->\n<!-- PAGE 1: INVOICE SECTION -->\n<!-- ========================================== -->\n\n<div class=\"row\">\n    <div class=\"col-md-12\" style=\"display:flex; width:100%;margin-top:-20px; margin-bottom:-20px;\">\n        <div {% if print_settings.repeat_header_footer %} id=\"header-html\" class=\"hidden-pdf\" > {% endif %}\n        {% if doc.company == \"Numero Uno Training and Consulting LLC\" %}\n            {% set letter_head=frappe.get_doc(\"Letter Head\",\"Letter Head New\") %}\n            {% if letter_head %}\n                <div class=\"letter-head\">\n                    {{ letter_head.content }}\n                </div>\n            {% endif -%}\n        {% endif -%}\n        <div class=\"row\" style=\"text-align: CENTER ;margin-top:0px;\">\n            <h2><b>TAX INVOICE</b></h2>\n            {% if doc.company_trn %}\n                <span style=\"font-size:12px;\"><b>TRN: {{doc.company_trn}}</b></span>\n            {% endif %}\n        </div>\n        {% if doc.status == \"Draft\" %}\n            <div class=\"col-md-12\" align=\"center\">\n                <span style=\"color:blue;text-transform:uppercase;border:2px solid blue;padding:2px;\"><b>{{doc.status}}</b></span>\n            </div>\n        {% endif %}\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-6 d-flex flex-column justify-content-between\" style=\"width:50%; margin-top:0%; float:left; font-size:11px;\">\n        <div style=\"width:100%;\">\n            <h5><b>Invoice To:</b></h5>\n            <span style=\"font-size:12px;\"><b>{{doc.customer}}</b></span>\n            <p>{{doc.address_display or ''}}</p>\n            <p><b>Contact Name:</b> {{doc.contact_display or ''}}</p>\n            <p><b>Customer TRN:</b> {{doc.tax_id or ''}}</p>\n        </div>\n    </div><br>\n    <div class=\"col-md-6\" style=\"height:100%;width:50%;float:right; margin-top:0px\">\n        <table class=\"table table-bordered\" style=\"margin-top:-10px; margin-bottom:0px;\">\n            <tr><th style=\"width:40%;text-align:left;\">Invoice No</th><td>{{doc.name}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">Date</th><td>{{doc.get_formatted(\"posting_date\") or ''}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">LPO No</th><td>{{doc.po_no or ''}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">Payment Terms</th><td>{{doc.payment_terms_template or ''}}</td></tr>\n            <tr style=\"word-wrap: break-word;\">\n                <th style=\"width:40%;text-align:left;\">Sales Manager</th>\n                {% if doc.sales_team %}\n                    {% for row in doc.sales_team %}\n                        <td>{{row.sales_person or ''}}</td>\n                    {% endfor %}\n                {% else %}\n                    <td></td>\n                {%endif%}\n        </table>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-12\" style=\"width:100%; margin-top: 0%;\">\n        <table class=\"table table-bordered\" style=\"margin-top: 0%;\">\n            <thead>\n                <tr>\n                    <th style=\"width:3%\">No</th>\n                    <th style=\"width:35%\">Description</th>\n                    <th style=\"width:7%;\">Qty</th>\n                    <th style=\"width:10%;\">Unit Rate</th>\n                    <th style=\"width:13%;\">Amount</th>\n                    <th style=\"width:7%;\">VAT %</th>\n                    <th style=\"width:10%;\">VAT Amt</th>\n                    <th style=\"width:15%;\">Total Amount</th>\n                </tr>\n            </thead>\n            <tbody>\n                {% for item in doc.items %}\n                    {% set std_count = frappe.db.get_all('Sales Invoice Student', filters={ 'parent': doc.name, 'course': item.item_code }, fields=['count(course) as stud_count', 'student_group', 'start_date', 'end_date'], group_by = \"student_group\", as_list=False) %}\n                    <tr>\n                        <td style=\"text-align:center;\">{{item.idx}}</td>\n                        <td><b>{{item.item_code}}</b>\n                            <br><br>\n                            {% for s_grp in std_count %}\n                                <b>Training Ref No. &nbsp;: {{ s_grp.student_group }}</b><br>\n                                No of candidates &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: {{s_grp.stud_count}}<br>\n                                Training Start Date &nbsp;: {{frappe.utils.format_date(s_grp.start_date)}}<br>\n                                Training End Date &nbsp;&nbsp;&nbsp;: {{frappe.utils.format_date(s_grp.end_date)}}\n                                <br><br>\n                            {% endfor %}\n                        </td>\n                        <td style=\"text-align:center;\">\n                            {{\"{:,.0f}\".format(item.qty)}}\n                            <span class=\"light\">{{item.uom}}</span>\n                        </td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.rate)}}</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.amount)}}</td>\n                        <td style=\"text-align:center;\">5%</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.tax_amount)}}</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.amount+item.tax_amount)}}</td>\n                    </tr>\n                {% endfor %}\n            </tbody>\n        </table>\n    </div>\n</div>\n\n<div class=\"row no-page-break\">\n    <div class=\"col-md-12\">\n        <div class=\"row\">\n            <div class=\"col-md-6 no-page-break\" style=\"width:58%;float:Left; margin-top:-20px;\">\n                <div class=\"no-page-break\">\n                    Amount in Words:&nbsp;&nbsp;<span style=\"font-weight:bold;font-style:italic;font-size:11px;\">{{doc.in_words}}</span>\n                    <br><br>\n                    <p><span style=\"font-size:11px;\"><b>Bank Details &nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;</b></span></p>\n                    <p><span style=\"font-size:11px;\">Account Name &nbsp;&nbsp;:&nbsp; {{ doc.company or '' }} </span></p>\n                    <p><span style=\"font-size:11px;\">Account No &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; {{ doc.bank_account_no or '' }} </span></p>\n                    <p><span style=\"font-size:11px;\">Bank Name &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; {{ doc.bank_name or '' }} </span></p>\n                    <p><span style=\"font-size:11px;\">IBAN No &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; {{ doc.iban_no or '' }} </span></p>\n                    <p><span style=\"font-size:11px;\">Swift Code &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: {{ doc.swift_number or '' }} </span></p><br>\n                </div>\n            </div>\n            <div class=\"col-md-6\" style=\"width:42%;float:right; margin-top:-45px;\">\n                <div>\n                    <table class=\"table table-bordered totalTable\">\n                        <tr><th style=\"width:57.5%;text-align:left;\">Sub Total</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.total)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">Discount</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.discount_amount)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">Total Amount</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.net_total)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">VAT @ 5%</th><td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.total_taxes_and_charges)}}</td></tr>\n                        <tr class=\"totalRow\"><th style=\"text-align:left;\"><span style=\"font-weight:700;color:black;\">Amount Including VAT</span></th>\n                            <td style=\"text-align:right;\"><b>{{doc.currency}} {{\"{:,.2f}\".format(doc.grand_total)}}</b></td></tr>\n                        <tr><th style=\"width:57%;text-align:left;\">Advance Received </th>\n                            <td style=\"text-align:right;color:red;\"> (-) {{'%0.2f'%(doc.total_advance)|float}}</td></tr>\n                        <tr class=\"totalRow\"><th style=\"text-align:left;\"><span style=\"font-weight:700;color:black;\">Balance Due</span></th>\n                            <td style=\"text-align:right;\"><b>{{doc.currency}} {{\"{:,.2f}\".format(doc.outstanding_amount)}}</b></td></tr>\n                    </table>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"row footer\">\n    <div class=\"col-md-4 d-flex flex-column justify-content-between\" style=\"width:30%;float:left;font-size:11px;\">\n        <div style=\"width:100%;\">\n            <br><br><br><br><br><br>\n            <b>Preapred By</b>\n        </div>\n    </div>\n    <div class=\"col-md-4 d-flex flex-column justify-content-between\" style=\"width:30%;float:left;font-size:11px;\">\n        <div style=\"width:100%;\">\n            <br><br><br><br><br><br>\n            <b>Checked By</b>\n        </div>\n    </div>\n    <div class=\"col-md-4 d-flex flex-column justify-content-between\" style=\"width:40%;float:right;font-size:11px;\">\n        <div style=\"width:100%;\">\n            <br><br><br><br><br><br>\n            <b>For {{doc.company}}</b>\n        </div>\n    </div>\n</div>\n\n<!-- ========================================== -->\n<!-- PAGE 2: ACKNOWLEDGEMENT COPY -->\n<!-- ========================================== -->\n\n<div class=\"page-break\"></div>\n\n<div class=\"row\">\n    <div class=\"col-md-12\" style=\"display:flex; width:100%;margin-top:-20px; margin-bottom:-20px;\">\n        <div {% if print_settings.repeat_header_footer %} id=\"header-html\" class=\"hidden-pdf\" > {% endif %}\n        {% if doc.company == \"Numero Uno Training and Consulting LLC\" %}\n            {% set letter_head=frappe.get_doc(\"Letter Head\",\"Letter Head New\") %}\n            {% if letter_head %}\n                <div class=\"letter-head\">\n                    {{ letter_head.content }}\n                </div>\n            {% endif -%}\n        {% endif -%}\n        <div class=\"row\" style=\"text-align: CENTER ;margin-top:0px;\">\n            <h2><b>TAX INVOICE</b></h2>\n            {% if doc.company_trn %}\n                <span style=\"font-size:12px;\"><b>TRN: {{doc.company_trn}}</b></span>\n            {% endif %}\n        </div>\n        {% if doc.status == \"Draft\" %}\n            <div class=\"col-md-12\" align=\"center\">\n                <span style=\"color:blue;text-transform:uppercase;border:2px solid blue;padding:2px;\"><b>{{doc.status}}</b></span>\n            </div>\n        {% endif %}\n        </div>\n    </div>\n</div>\n\n<div style=\"margin-left:70%; font-size:15px;\">\n    <p><b>(Acknowledgement Copy)</b></p>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-6 d-flex flex-column justify-content-between\" style=\"width:50%; margin-top:-2%; float:left; font-size:11px;\">\n        <div style=\"width:100%;\">\n            <h5><b>Invoice To:</b></h5>\n            <span style=\"font-size:12px;\"><b>{{doc.customer}}</b></span>\n            <p>{{doc.address_display or ''}}</p>\n            <p><b>Contact Name:</b> {{doc.contact_display or ''}}</p>\n            <p><b>Customer TRN:</b> {{doc.tax_id or ''}}</p>\n        </div>\n    </div><br>\n    <div class=\"col-md-6\" style=\"height:100%;width:50%;float:right; margin-top:0px\">\n        <table class=\"table table-bordered\" style=\"margin-top:-10px; margin-bottom:0px;\">\n            <tr><th style=\"width:40%;text-align:left;\">Invoice No</th><td>{{doc.name}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">Date</th><td>{{doc.get_formatted(\"posting_date\") or ''}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">LPO No</th><td>{{doc.po_no or ''}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">Payment Terms</th><td>{{doc.payment_terms_template or ''}}</td></tr>\n            <tr style=\"word-wrap: break-word;\">\n                <th style=\"width:40%;text-align:left;\">Sales Manager</th>\n                {% if doc.sales_team %}\n                    {% for row in doc.sales_team %}\n                        <td>{{row.sales_person or ''}}</td>\n                    {% endfor %}\n                {% else %}\n                    <td></td>\n                {%endif%}\n        </table>\n    </div>\n</div>\n\n<div class=\"no-page-break\">\n    <div class=\"col-md-12\" style=\"width:100%; margin-top: 0%;\">\n        <table class=\"table table-bordered\" style=\"margin-top: 0%;\">\n            <thead>\n                <tr>\n                    <th style=\"width:3%\">No</th>\n                    <th style=\"width:35%\">Description</th>\n                    <th style=\"width:7%;\">Qty</th>\n                    <th style=\"width:10%;\">Unit Rate</th>\n                    <th style=\"width:13%;\">Amount</th>\n                    <th style=\"width:7%;\">VAT %</th>\n                    <th style=\"width:10%;\">VAT Amt</th>\n                    <th style=\"width:15%;\">Total Amount</th>\n                </tr>\n            </thead>\n            <tbody>\n                {% for item in doc.items %}\n                    {% set std_count = frappe.db.get_all('Sales Invoice Student', filters={ 'parent': doc.name, 'course': item.item_code }, fields=['count(course) as stud_count', 'student_group', 'start_date', 'end_date'], group_by = \"student_group\", as_list=False) %}\n                    <tr>\n                        <td style=\"text-align:center;\">{{item.idx}}</td>\n                        <td><b>{{item.item_code}}</b>\n                            <br><br>\n                            {% for s_grp in std_count %}\n                                <b>Training Ref No. &nbsp;: {{ s_grp.student_group }}</b><br>\n                                No of candidates &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: {{s_grp.stud_count}}<br>\n                                Training Start Date &nbsp;: {{frappe.utils.format_date(s_grp.start_date)}}<br>\n                                Training End Date &nbsp;&nbsp;&nbsp;: {{frappe.utils.format_date(s_grp.end_date)}}\n                                <br><br>\n                            {% endfor %}\n                        </td>\n                        <td style=\"text-align:center;\">\n                            {{\"{:,.0f}\".format(item.qty)}}\n                            <span class=\"light\">{{item.uom}}</span>\n                        </td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.rate)}}</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.amount)}}</td>\n                        <td style=\"text-align:center;\">5%</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.tax_amount)}}</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.amount+item.tax_amount)}}</td>\n                    </tr>\n                {% endfor %}\n            </tbody>\n        </table>\n    </div>\n</div>\n\n<div class=\"row no-page-break\">\n    <div class=\"col-md-12\">\n        <div class=\"row\">\n            <div class=\"col-md-6 no-page-break\" style=\"width:58%;float:Left; margin-top:-16px;\">\n                <div class=\"no-page-break\">\n                    Amount in Words:&nbsp;&nbsp;<span style=\"font-weight:bold;font-style:italic;font-size:11px;\">{{doc.in_words}}</span>\n                    <br><br>\n                    <p><span style=\"font-size:11px;\"><b>Acknoweledgement Details &nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;</b></span></p><br>\n                    <p><span style=\"font-size:11px;\"><b>Document Inside &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; Certficates (&nbsp;&nbsp;) / Cards (&nbsp;&nbsp;) </b></span></p><br>\n                    <p><span style=\"font-size:11px;\">Name of the Receiver &nbsp;&nbsp;&nbsp;:&nbsp; _______________________</span></p><br>\n                    <p><span style=\"font-size:11px;\">Date of Receiving &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; _______________________</span></p><br>\n                    <p><span style=\"font-size:11px;\">Contact No. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; _______________________</span></p>\n                </div>\n            </div>\n            <div class=\"col-md-6\" style=\"width:42%;float:right; margin-top:-40px;\">\n                <div class=\"no-page-break\">\n                    <table class=\"table table-bordered totalTable\">\n                        <tr><th style=\"width:57.5%;text-align:left;\">Sub Total</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.total)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">Discount</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.discount_amount)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">Total Amount</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.net_total)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">VAT @ 5%</th><td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.total_taxes_and_charges)}}</td></tr>\n                        <tr class=\"totalRow\"><th style=\"text-align:left;\"><span style=\"font-weight:700;color:black;\">Amount Including VAT</span></th>\n                            <td style=\"text-align:right;\"><b>{{doc.currency}} {{\"{:,.2f}\".format(doc.grand_total)}}</b></td></tr>\n                        <tr><th style=\"width:57%;text-align:left;\">Advance Received </th>\n                            <td style=\"text-align:right;color:red;\"> (-) {{'%0.2f'%(doc.total_advance)|float}}</td></tr>\n                        <tr class=\"totalRow\"><th style=\"text-align:left;\"><span style=\"font-weight:700;color:black;\">Balance Due</span></th>\n                            <td style=\"text-align:right;\"><b>{{doc.currency}} {{\"{:,.2f}\".format(doc.outstanding_amount)}}</b></td></tr>\n                    </table>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-7 d-flex flex-column justify-content-between\" style=\"width:60%;float:left;font-size:11px;\">\n        <div style=\"width:100%;\">\n            <br><br><br>\n            <b>Signature and Stamp &nbsp;&nbsp;: _______________________</b>\n        </div>\n    </div>\n    <div class=\"col-md-5 d-flex flex-column justify-content-between\" style=\"width:40%;float:right;font-size:11px;\">\n        <div style=\"width:100%;\">\n            <br>\n            <b>Delivered By : _______________________</b>\n            <br><br>\n            <b>Delivered On : _______________________</b>\n        </div>\n    </div>\n</div>\n\n<!-- ========================================== -->\n<!-- PAGE 3: STUDENT ATTENDANCE & CERTIFICATE/CARD TABLE -->\n<!-- ========================================== -->\n\n<div class=\"page-break\"></div>\n\n<!--<h4>Student Attendance & Certificate/Card Details</h4>-->\n\n<!-- ========================================== -->\n<!-- PAGE 4+: CERTIFICATES FOR EACH STUDENT -->\n<!-- ========================================== -->\n\n{% for row in doc.student %}\n    {% if not loop.first %}\n        <div class=\"page-break\"></div>\n    {% endif %}\n    \n    <div style=\"position: relative; width: 100%; font-family: Arial, sans-serif;\">\n        <div style=\"text-align: left; margin-bottom: 20px;\">\n            <img src=\"/files/Logo.PNG\" width=\"80\" height=\"80\" alt=\"Logo\">\n        </div>\n\n        <br/><br/><br/>\n\n        <!-- Header Logo & Titles -->\n        <div style=\"text-align: center; margin-bottom: 20px;\">\n            <h1 style=\"color: blue; margin: 5px 0; font-size:30px\">NUMERO UNO TRAINING &amp; CONSULTING LLC</h1>\n            <h3 style=\"margin: 0;\">CERTIFICATE OF COMPLETION / ATTENDANCE</h3>\n        </div>\n        <br/>\n\n        <!-- Student Name & Standard Text -->\n        <div style=\"text-align: center; margin: 20px 0;\">\n            <h4 style=\"margin-bottom: 10px;\"><strong>This is to certify that</strong></h4>\n            <h2 style=\"margin: 0 0 20px;\">{{ row.student_name }}</h2>\n            <br/>\n            <p style=\"margin: 0 0 10px;\">\n                <strong>attended and has been assessed against, and met the outcomes of,\n                the following OPITO-approved standard:</strong>\n            </p>\n            \n            {% if doc.program %}\n                {{doc.program}}\n            {% endif %}\n            \n            <br/>\n            \n            {% if doc.course %}\n                {{doc.course}}\n            {% endif %}\n\n\n\n\n                        <!-- Formatted Award Date -->\n            {% set dt = frappe.utils.get_datetime(doc.custom_certificate_validity_date) %}\n            {% if dt %}\n                {% set day = dt.day %}\n                {% set suffix = (\n                     'th' if 11 <= day <= 13 else\n                     'st' if day % 10 == 1 else\n                     'nd' if day % 10 == 2 else\n                     'rd' if day % 10 == 3 else\n                     'th'\n                ) %}\n                <p style=\"margin-top: 10px; font-style: italic;\">\n                    Awarded on {{ day }}{{ suffix }} {{ dt.strftime(\"%B %Y\") }}\n                </p>\n            {% endif %}\n\n->\n\n            <!-- Formatted Award Date -->\n            {% if doc.custom_certificate_validity_date %}\n                {% set dt = frappe.utils.get_datetime(doc.custom_certificate_validity_date) %}\n                {% if dt %}\n                    {% set day = dt.day %}\n                    {% set suffix = (\n                         'th' if 11 <= day <= 13 else\n                         'st' if day % 10 == 1 else\n                         'nd' if day % 10 == 2 else\n                         'rd' if day % 10 == 3 else\n                         'th'\n                    ) %}\n                    <p style=\"margin-top: 10px; font-style: italic;\">\n                        Awarded on {{ day }}{{ suffix }} {{ dt.strftime(\"%B %Y\") }}\n                    </p>\n                {% endif %}\n            {% endif %}\n            \n          \n        </div>\n\n        <!-- Course / Expiry / Certificate Details -->\n        <table style=\"width: 60%; margin: 0 auto 30px; font-size: 12px;\">\n    <tr>\n        <td><strong>Course Date</strong></td>\n        <td>:</td>\n        <td style=\"border-bottom: 1px dotted #000;\">\n            {% if doc.course_start_date and doc.course_end_date %}\n                {% if doc.course_start_date != doc.course_end_date %}\n                    {{ frappe.utils.get_datetime(doc.course_start_date).strftime(\"%d-%m-%Y\") }}\n                    to\n                    {{ frappe.utils.get_datetime(doc.course_end_date).strftime(\"%d-%m-%Y\") }}\n                {% else %}\n                    {{ frappe.utils.get_datetime(doc.course_start_date).strftime(\"%d-%m-%Y\") }}\n                {% endif %}\n            {% else %}\n                N/A\n            {% endif %}\n        </td>\n    </tr>\n    <tr>\n        <td><strong>Expiry Date</strong></td>\n        <td>:</td>\n        <td style=\"border-bottom: 1px dotted #000;\">\n            {% if doc.validity_period and doc.validity_period != 'NA' and doc.certificate_validity_date %}\n                {{ frappe.utils.get_datetime(doc.certificate_validity_date).strftime(\"%d-%m-%Y\") }}\n            {% else %}\n                N/A\n            {% endif %}\n        </td>\n    </tr>\n    <tr>\n        <td><strong>Certificate No</strong></td>\n        <td>:</td>\n        <td style=\"border-bottom: 1px dotted #000;\">\n            {{ doc.name }}-{{ row.idx }}\n        </td>\n    </tr>\n</table>\n        \n        <!-- full-width 1\u00d73 table -->\n        <table style=\"width:100%; margin:40px 0; border-collapse:collapse;\">\n            <tr>\n                <!-- Instructor cell -->\n                <td style=\"width:33%; text-align:center; vertical-align:middle;\">\n                    {% set instructor_name = frappe.db.get_value(\n                         \"Student Group Instructor\",\n                         {\"parent\": doc.select_student_group[0].name if doc.select_student_group else \"\"},\n                         \"instructor_name\"\n                    ) %}\n                    {% if instructor_name %}\n                        <img\n                            src=\"/files/signatureinstructor.png\"\n                            width=\"120\" height=\"80\"\n                            alt=\"Instructor Signature\"\n                            style=\"display:block; margin:0 auto 8px;\"\n                        />\n                        {{ instructor_name }}\n                    {% endif %}\n                    <br/>\n                    Instructor\n                </td>\n\n                <!-- QR code cell -->\n                <td style=\"width:33%; text-align:center; vertical-align:middle;\">\n                    {% set pf   = \"Assessment Certificate\" %}\n                    {% set lh   = \"0\" %}\n                    {% set lang = frappe.local.lang or \"en\" %}\n                    {% set base = frappe.utils.get_url() %}\n                    {% set print_url =\n                         base ~ \"/printview\"\n                         ~ \"?doctype=\"  ~ doc.doctype|urlencode\n                         ~ \"&name=\"     ~ doc.name|urlencode\n                         ~ \"&format=\"   ~ pf|urlencode\n                         ~ \"&no_letterhead=0\"\n                         ~ \"&letterhead=\"  ~ lh|urlencode\n                         ~ \"&settings=%7B%7D\"\n                         ~ \"&_lang=\"    ~ lang|urlencode\n                    %}\n                    <img\n                        src=\"https://barcode.tec-it.com/barcode.ashx?data={{ print_url|urlencode }}&code=QRCode&dpi=150\"\n                        width=\"120\" height=\"120\"\n                        alt=\"QR code for {{ doc.name }}-{{ row.idx }}\"\n                    />\n                </td>\n\n                <!-- Academic Director cell -->\n                <td style=\"width:33%; text-align:center; vertical-align:middle;\">\n                    <img\n                        src=\"/files/signatureinstructor.png\"\n                        width=\"120\" height=\"80\"\n                        alt=\"Director Signature\"\n                        style=\"display:block; margin:0 auto 8px;\"\n                    />\n                    Academic Director      \n                </td>\n            </tr>\n        </table>\n\n        <!-- Footer Image -->\n        <div style=\"text-align: center;\">\n            <img src=\"/files/Certificate Footer.PNG\" style=\"width: 100%;\" alt=\"Footer\">\n        </div>\n    </div>\n{% endfor %}\n\n<!-- ========================================== -->\n<!-- FINAL PAGE: ATTENDANCE SHEET -->\n<!-- ========================================== -->\n\n<div class=\"page-break\"></div>\n{%- from \"templates/print_formats/standard_macros.html\" import add_header -%}\n<div class=\"row\">\n    <div class=\"col-md-12\" style=\"display:flex; width:100%;margin-top:-20px; margin-bottom:-20px;\">\n        <div {% if print_settings.repeat_header_footer %} id=\"header-html\" class=\"hidden-pdf\">\n            {% endif %}\n\n            {% set letter_head = frappe.get_doc(\"Letter Head\", \"Letter Head New\") %}\n\n            {% if letter_head %}\n                <div class=\"letter-head\"> {{ letter_head.content }} </div>\n\n                <div class=\"row\" style=\"text-align: CENTER ;margin-top:0px;\">\n                    <h2><b><u>ATTENDANCE SHEET</u></b></h2>\n                </div>\n\n                <div style=\"margin-top:2%;\">\n                    <div class=\"col-1\">\n                        <p><b>Sheet No : {{ doc.name }}</b></p>\n                        <p>Date : {{ frappe.utils.formatdate(doc.creation) }}</p>\n                       \n                    </div>\n                   \n                </div>\n            {% endif %}\n        </div>\n    </div>\n</div>\n<h4>Attendance Sheet</h4>\n<table width=\"100%\" style=\"border:1px solid black;margin-top:5%\">\n    <tr>\n        <!--<th width=\"10%\">S.No</th>-->\n        <!--<th>Name Of the Delegate</th>-->\n        <!--<th>Contact No.</th>-->\n        <!--<th>Nationality</th>-->\n        <!--<th>DOB</th>-->\n\n        {% for d in date_list %}\n             <th style=\"width:10%\">Day {{ loop.index }}</th>\n        {% endfor %}\n        <!--<th>Result</th>-->\n        <!--<th>Card Received</th>-->\n    </tr>\n\n{# --- Build unique date list for all students/groups --- #}\n{% set date_dict = {} %}\n{% for row in doc.student %}\n    {% for group in doc.select_student_group %}\n        {% set attendance_list = frappe.get_all(\n            \"Student Attendance\",\n            filters={\n                \"student_name\": row.student_name,\n                \"student_group\": group.student_group,\n            },\n            fields=[\"date\"],\n            order_by=\"date\"\n        ) %}\n        {% for att in attendance_list %}\n            {% set _ = date_dict.update({att.date:1}) %}\n        {% endfor %}\n    {% endfor %}\n{% endfor %}\n{% set date_list = date_dict.keys()|list|sort %}\n\n<table border=\"1\" style=\"width:100%; margin-top:20px;\">\n    <tr>\n        <th>S #</th>\n        <th>STUDENT NAME</th>\n        <th>GROUP</th>\n        {% for d in date_list %}\n            <th>{{ frappe.utils.formatdate(d, \"MM/dd/yy\") }}</th>\n        {% endfor %}\n        <th>Card Received</th>\n    </tr>\n    {% set count = 1 %}\n    {% for row in doc.student %}\n        {% for group in doc.select_student_group %}\n        <tr>\n            <td>{{ count }}</td>\n            <td>{{ row.student_name }}</td>\n            <td>{{ group.student_group }}</td>\n            {% for d in date_list %}\n                {% set att = frappe.get_all(\n                    \"Student Attendance\",\n                    filters={\n                        \"student_name\": row.student_name,\n                        \"student_group\": group.student_group,\n                        \"date\": d\n                    },\n                    fields=[\"status\"]\n                ) %}\n                <td style=\"text-align:center;\">\n                    {% if att and att[0].status %}\n                        {% if att[0].status == \"Present\" %}\n                            P\n                        {% elif att[0].status == \"Absent\" %}\n                            A\n                        {% else %}\n                            {{ att[0].status }}\n                        {% endif %}\n                    {% else %}\n                        -\n                    {% endif %}\n                </td>\n            {% endfor %}\n            {# Student Card Signature by student only #}\n            {% set s_card_name = frappe.db.get_value(\"Student Card\", {\n                \"student\": row.student\n            }) %}\n            {% if s_card_name %}\n                {% set s_card = frappe.get_doc(\"Student Card\", s_card_name) %}\n            {% else %}\n                {% set s_card = None %}\n            {% endif %}\n            <td style=\"text-align:center;\">\n                {% if s_card and s_card.student_signature %}\n                    <img src=\"{{ s_card.student_signature }}\"\n                         style=\"max-width: 100px; max-height: 40px; object-fit: contain; display: inline-block;\" \n                         alt=\"Signature\" />\n                {% else %}\n                    No Signature\n                {% endif %}\n            </td>\n        </tr>\n        {% set count = count + 1 %}\n        {% endfor %}\n    {% endfor %}\n</table>\n\n\n\n\n<footer class=\"print-footer\">\n    <div class=\"col-md-12\">\n        <div class=\"row\">\n            <div id=\"footer-html\" class=\"hidden-pdf\">\n                <div class=\"letter-head-footer\">\n                    <table width=\"100%\">\n                        <tr>\n                            <th>Po Box 132435, ICAD, Behind Dalma Mall Block B Mussaffah, Abu Dhabi, U.A.E</th>\n                        </tr>\n                    </table>\n                </div>\n            </div>\n        </div>\n    </div>\n</footer>",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-07-14 12:02:27.879534",
 "modified_by": "Administrator",
 "module": "Numerouno",
 "name": "Invoice, Certificate, Attendance, Card",
 "owner": "Administrator",
 "page_number": "Hide",
 "pdf_generator": "wkhtmltopdf",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}