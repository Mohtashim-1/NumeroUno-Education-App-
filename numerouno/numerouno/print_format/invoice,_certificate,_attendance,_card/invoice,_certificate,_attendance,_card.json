{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-07-14 03:13:43.229798",
 "css": ".print-format {\r\n    font-size: 12px;\r\n    background: solid white;\r\n}\r\n\r\n.print-format .first-page-footer {\r\n    margin-top: 100%;\r\n    color:red;\r\n}\r\n\r\n.print-heading {\r\n    border-bottom: 1px solid black;\r\n    font-weight: 400;\r\n    padding: 1px;\r\n    margin-bottom: 2px;\r\n    margin-top: 1px;\r\n    color:black;\r\n}\r\n\r\n.print-heading h2 {\r\n    font-size: 20px;\r\n    }\r\n\r\n.print-heading h2 div {\r\n    font-weight: 400;\r\n    padding-bottom: 1px;\r\n    margin-bottom: 2px;\r\n    margin-top: 2px;\r\n    color: black;\r\n}\r\n\r\n.print-heading h2 br{\r\n    display:none;\r\n}\r\n\r\n.print-heading small {\r\n    font-size: 13px !important;\r\n    font-weight: normal;\r\n    line-height: 1;\r\n    color: black;\r\n    margin-top: 1px;\r\n}\r\n\r\n.print-format .letter-head {\r\n    margin-bottom: 1px;\r\n}\r\n\r\n.print-format label {\r\n    font-weight: 600;\r\n    font-size: 12px;\r\n     /*color: #821f17; */\r\n    line-height: 1;\r\n    margin-bottom: 0;\r\n}\r\n\r\n.print-format .data-field {\r\n    margin-top: 0;\r\n    margin-bottom: 0;\r\n}\r\n\r\n.print-format .value {\r\n    color: black;\r\n    line-height: 1.2;\r\n}\r\n\r\n.print-format .row:not(.section-break) {\r\n    line-height: 1;\r\n    margin-top: 6px !important;\r\n    margin-bottom: 6px !important;\r\n    color:black;\r\n}\r\n\r\n.print-format .important .value {\r\n    font-size: 13px;\r\n    font-weight: 600;\r\n    \r\n}\r\n\r\n.print-format th {\r\n    border:1px solid black;\r\n     /*color: #e3e3e3; */\r\n    /*background-color: #821f17;*/\r\n    /* background-color: #808080; */\r\n    text-transform: uppercase;\r\n    font-weight: 600;\r\n    font-size: 10px !important;\r\n    text-align: center;\r\n}\r\n\r\n.print-format .table-bordered td, .print-format .table-bordered th {\r\n    border: 1px solid black;\r\n    \r\n}\r\n\r\n.print-format .table-bordered {\r\n    vertical-align: middle !important;\r\n    border: 1px solid black;\r\n\r\n}\r\n\r\n.print-format td, .print-format th {\r\n    vertical-align: middle !important;\r\n    font-size: 10px !important;\r\n    padding: 2px !important;\r\n}\r\n.text-container {\r\n    position: relative;\r\n    height: 100%;\r\n}\r\n\r\n    .bottom-paragraph {\r\n        position: fixed;\r\n        bottom: 0;\r\n        left: 0;\r\n        right: 0;\r\n        text-align: center;\r\n        background-color: #f2f2f2;\r\n        padding: 10px;\r\n    }\r\n\r\n.no-page-break{\r\n    page-break-inside:avoid;\r\n}\r\n\r\n.page-break{\r\n    page-break-before:always;\r\n}\r\n.page-number-container {\r\n    position: absolute;\r\n    bottom: 10px; \r\n    right: 10px; \r\n}\r\n\r\n\r\n",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Sales Invoice",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{%- from \"templates/print_formats/standard_macros.html\" import add_header -%}\n\n<style>\n.page-break {\n    page-break-before: always;\n}\n.no-page-break {\n    page-break-inside: avoid;\n}\n</style>\n\n{# ===================================================== #}\n{# 1) INVOICE + ACKNOWLEDGEMENT  (controlled by custom_include_invoice) #}\n{# ===================================================== #}\n\n{% if doc.custom_include_invoice %}\n\n<!-- ========================================== -->\n<!-- PAGE 1: INVOICE SECTION -->\n<!-- ========================================== -->\n\n<div class=\"row\">\n    <div class=\"col-md-12\" style=\"display:flex; width:100%;margin-top:-20px; margin-bottom:-20px;\">\n        <div {% if print_settings.repeat_header_footer %} id=\"header-html\" class=\"hidden-pdf\" > {% endif %}\n        {% if doc.company == \"Numero Uno Training and Consulting LLC\" %}\n            {% set letter_head=frappe.get_doc(\"Letter Head\",\"Letter Head New\") %}\n            {% if letter_head %}\n                <div class=\"letter-head\">\n                    {{ letter_head.content }}\n                </div>\n            {% endif -%}\n        {% endif -%}\n        <div class=\"row\" style=\"text-align: CENTER ;margin-top:0px;\">\n            <h2><b>TAX INVOICE</b></h2>\n            {% if doc.company_trn %}\n                <span style=\"font-size:12px;\"><b>TRN: {{doc.company_trn}}</b></span>\n            {% endif %}\n        </div>\n        {% if doc.status == \"Draft\" %}\n            <div class=\"col-md-12\" align=\"center\">\n                <span style=\"color:blue;text-transform:uppercase;border:2px solid blue;padding:2px;\"><b>{{doc.status}}</b></span>\n            </div>\n        {% endif %}\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-6 d-flex flex-column justify-content-between\" style=\"width:50%; margin-top:0%; float:left; font-size:11px;\">\n        <div style=\"width:100%;\">\n            <h5><b>Invoice To:</b></h5>\n            <span style=\"font-size:12px;\"><b>{{doc.customer}}</b></span>\n            <p>{{doc.address_display or ''}}</p>\n            <p><b>Contact Name:</b> {{doc.contact_display or ''}}</p>\n            <p><b>Customer TRN:</b> {{doc.tax_id or ''}}</p>\n        </div>\n    </div><br>\n    <div class=\"col-md-6\" style=\"height:100%;width:50%;float:right; margin-top:0px\">\n        <table class=\"table table-bordered\" style=\"margin-top:-10px; margin-bottom:0px;\">\n            <tr><th style=\"width:40%;text-align:left;\">Invoice No</th><td>{{doc.name}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">Date</th><td>{{doc.get_formatted(\"posting_date\") or ''}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">LPO No</th><td>{{doc.po_no or ''}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">Payment Terms</th><td>{{doc.payment_terms_template or ''}}</td></tr>\n            <tr style=\"word-wrap: break-word;\">\n                <th style=\"width:40%;text-align:left;\">Sales Manager</th>\n                {% if doc.sales_team %}\n                    {% for row in doc.sales_team %}\n                        <td>{{row.sales_person or ''}}</td>\n                    {% endfor %}\n                {% else %}\n                    <td></td>\n                {%endif%}\n        </table>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-12\" style=\"width:100%; margin-top: 0%;\">\n        <table class=\"table table-bordered\" style=\"margin-top: 0%;\">\n            <thead>\n                <tr>\n                    <th style=\"width:3%\">No</th>\n                    <th style=\"width:35%\">Description</th>\n                    <th style=\"width:7%;\">Qty</th>\n                    <th style=\"width:10%;\">Unit Rate</th>\n                    <th style=\"width:13%;\">Amount</th>\n                    <th style=\"width:7%;\">VAT %</th>\n                    <th style=\"width:10%;\">VAT Amt</th>\n                    <th style=\"width:15%;\">Total Amount</th>\n                </tr>\n            </thead>\n            <tbody>\n                {% for item in doc.items %}\n                    {% set std_count = frappe.db.get_all(\n                        'Sales Invoice Student',\n                        filters={ 'parent': doc.name, 'course': item.item_code },\n                        fields=['count(course) as stud_count', 'student_group', 'start_date', 'end_date'],\n                        group_by = \"student_group\",\n                        as_list=False\n                    ) %}\n                    <tr>\n                        <td style=\"text-align:center;\">{{item.idx}}</td>\n                        <td><b>{{item.item_code}}</b>\n                            <br><br>\n                            {% for s_grp in std_count %}\n                                <b>Training Ref No. &nbsp;: {{ s_grp.student_group }}</b><br>\n                                No of candidates &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: {{s_grp.stud_count}}<br>\n                                Training Start Date &nbsp;: {{frappe.utils.format_date(s_grp.start_date)}}<br>\n                                Training End Date &nbsp;&nbsp;&nbsp;: {{frappe.utils.format_date(s_grp.end_date)}}\n                                <br><br>\n                            {% endfor %}\n                        </td>\n                        <td style=\"text-align:center;\">\n                            {{\"{:,.0f}\".format(item.qty)}}\n                            <span class=\"light\">{{item.uom}}</span>\n                        </td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.rate)}}</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.amount)}}</td>\n                        <td style=\"text-align:center;\">5%</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.tax_amount)}}</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.amount+item.tax_amount)}}</td>\n                    </tr>\n                {% endfor %}\n            </tbody>\n        </table>\n    </div>\n</div>\n\n<div class=\"row no-page-break\">\n    <div class=\"col-md-12\">\n        <div class=\"row\">\n            <div class=\"col-md-6 no-page-break\" style=\"width:58%;float:Left; margin-top:-20px;\">\n                <div class=\"no-page-break\">\n                    Amount in Words:&nbsp;&nbsp;<span style=\"font-weight:bold;font-style:italic;font-size:11px;\">{{doc.in_words}}</span>\n                    <br><br>\n                    <p><span style=\"font-size:11px;\"><b>Bank Details &nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;</b></span></p>\n                    <p><span style=\"font-size:11px;\">Account Name &nbsp;&nbsp;:&nbsp; {{ doc.company or '' }} </span></p>\n                    <p><span style=\"font-size:11px;\">Account No &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; {{ doc.bank_account_no or '' }} </span></p>\n                    <p><span style=\"font-size:11px;\">Bank Name &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; {{ doc.bank_name or '' }} </span></p>\n                    <p><span style=\"font-size:11px;\">IBAN No &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; {{ doc.iban_no or '' }} </span></p>\n                    <p><span style=\"font-size:11px;\">Swift Code &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: {{ doc.swift_number or '' }} </span></p><br>\n                </div>\n            </div>\n            <div class=\"col-md-6\" style=\"width:42%;float:right; margin-top:-45px;\">\n                <div>\n                    <table class=\"table table-bordered totalTable\">\n                        <tr><th style=\"width:57.5%;text-align:left;\">Sub Total</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.total)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">Discount</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.discount_amount)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">Total Amount</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.net_total)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">VAT @ 5%</th><td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.total_taxes_and_charges)}}</td></tr>\n                        <tr class=\"totalRow\"><th style=\"text-align:left;\"><span style=\"font-weight:700;color:black;\">Amount Including VAT</span></th>\n                            <td style=\"text-align:right;\"><b>{{doc.currency}} {{\"{:,.2f}\".format(doc.grand_total)}}</b></td></tr>\n                        <tr><th style=\"width:57%;text-align:left;\">Advance Received </th>\n                            <td style=\"text-align:right;color:red;\"> (-) {{'%0.2f'%(doc.total_advance)|float}}</td></tr>\n                        <tr class=\"totalRow\"><th style=\"text-align:left;\"><span style=\"font-weight:700;color:black;\">Balance Due</span></th>\n                            <td style=\"text-align:right;\"><b>{{doc.currency}} {{\"{:,.2f}\".format(doc.outstanding_amount)}}</b></td></tr>\n                    </table>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"row footer\">\n    <div class=\"col-md-4 d-flex flex-column justify-content-between\" style=\"width:30%;float:left;font-size:11px;\">\n        <div style=\"width:100%;\">\n            <br><br><br><br><br><br>\n            <b>Preapred By</b>\n        </div>\n    </div>\n    <div class=\"col-md-4 d-flex flex-column justify-content-between\" style=\"width:30%;float:left;font-size:11px;\">\n        <div style=\"width:100%;\">\n            <br><br><br><br><br><br>\n            <b>Checked By</b>\n        </div>\n    </div>\n    <div class=\"col-md-4 d-flex flex-column justify-content-between\" style=\"width:40%;float:right;font-size:11px;\">\n        <div style=\"width:100%;\">\n            <br><br><br><br><br><br>\n            <b>For {{doc.company}}</b>\n        </div>\n    </div>\n</div>\n\n<!-- ========================================== -->\n<!-- PAGE 2: ACKNOWLEDGEMENT COPY -->\n<!-- ========================================== -->\n\n<div class=\"page-break\"></div>\n\n<div class=\"row\">\n    <div class=\"col-md-12\" style=\"display:flex; width:100%;margin-top:-20px; margin-bottom:-20px;\">\n        <div {% if print_settings.repeat_header_footer %} id=\"header-html\" class=\"hidden-pdf\" > {% endif %}\n        {% if doc.company == \"Numero Uno Training and Consulting LLC\" %}\n            {% set letter_head=frappe.get_doc(\"Letter Head\",\"Letter Head New\") %}\n            {% if letter_head %}\n                <div class=\"letter-head\">\n                    {{ letter_head.content }}\n                </div>\n            {% endif -%}\n        {% endif -%}\n        <div class=\"row\" style=\"text-align: CENTER ;margin-top:0px;\">\n            <h2><b>TAX INVOICE</b></h2>\n            {% if doc.company_trn %}\n                <span style=\"font-size:12px;\"><b>TRN: {{doc.company_trn}}</b></span>\n            {% endif %}\n        </div>\n        {% if doc.status == \"Draft\" %}\n            <div class=\"col-md-12\" align=\"center\">\n                <span style=\"color:blue;text-transform:uppercase;border:2px solid blue;padding:2px;\"><b>{{doc.status}}</b></span>\n            </div>\n        {% endif %}\n        </div>\n    </div>\n</div>\n\n<div style=\"margin-left:70%; font-size:15px;\">\n    <p><b>(Acknowledgement Copy)</b></p>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-6 d-flex flex-column justify-content-between\" style=\"width:50%; margin-top:-2%; float:left; font-size:11px;\">\n        <div style=\"width:100%;\">\n            <h5><b>Invoice To:</b></h5>\n            <span style=\"font-size:12px;\"><b>{{doc.customer}}</b></span>\n            <p>{{doc.address_display or ''}}</p>\n            <p><b>Contact Name:</b> {{doc.contact_display or ''}}</p>\n            <p><b>Customer TRN:</b> {{doc.tax_id or ''}}</p>\n        </div>\n    </div><br>\n    <div class=\"col-md-6\" style=\"height:100%;width:50%;float:right; margin-top:0px\">\n        <table class=\"table table-bordered\" style=\"margin-top:-10px; margin-bottom:0px;\">\n            <tr><th style=\"width:40%;text-align:left;\">Invoice No</th><td>{{doc.name}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">Date</th><td>{{doc.get_formatted(\"posting_date\") or ''}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">LPO No</th><td>{{doc.po_no or ''}}</td></tr>\n            <tr><th style=\"width:40%;text-align:left;\">Payment Terms</th><td>{{doc.payment_terms_template or ''}}</td></tr>\n            <tr style=\"word-wrap: break-word;\">\n                <th style=\"width:40%;text-align:left;\">Sales Manager</th>\n                {% if doc.sales_team %}\n                    {% for row in doc.sales_team %}\n                        <td>{{row.sales_person or ''}}</td>\n                    {% endfor %}\n                {% else %}\n                    <td></td>\n                {%endif%}\n        </table>\n    </div>\n</div>\n\n<div class=\"no-page-break\">\n    <div class=\"col-md-12\" style=\"width:100%; margin-top: 0%;\">\n        <table class=\"table table-bordered\" style=\"margin-top: 0%;\">\n            <thead>\n                <tr>\n                    <th style=\"width:3%\">No</th>\n                    <th style=\"width:35%\">Description</th>\n                    <th style=\"width:7%;\">Qty</th>\n                    <th style=\"width:10%;\">Unit Rate</th>\n                    <th style=\"width:13%;\">Amount</th>\n                    <th style=\"width:7%;\">VAT %</th>\n                    <th style=\"width:10%;\">VAT Amt</th>\n                    <th style=\"width:15%;\">Total Amount</th>\n                </tr>\n            </thead>\n            <tbody>\n                {% for item in doc.items %}\n                    {% set std_count = frappe.db.get_all(\n                        'Sales Invoice Student',\n                        filters={ 'parent': doc.name, 'course': item.item_code },\n                        fields=['count(course) as stud_count', 'student_group', 'start_date', 'end_date'],\n                        group_by = \"student_group\",\n                        as_list=False\n                    ) %}\n                    <tr>\n                        <td style=\"text-align:center;\">{{item.idx}}</td>\n                        <td><b>{{item.item_code}}</b>\n                            <br><br>\n                            {% for s_grp in std_count %}\n                                <b>Training Ref No. &nbsp;: {{ s_grp.student_group }}</b><br>\n                                No of candidates &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: {{s_grp.stud_count}}<br>\n                                Training Start Date &nbsp;: {{frappe.utils.format_date(s_grp.start_date)}}<br>\n                                Training End Date &nbsp;&nbsp;&nbsp;: {{frappe.utils.format_date(s_grp.end_date)}}\n                                <br><br>\n                            {% endfor %}\n                        </td>\n                        <td style=\"text-align:center;\">\n                            {{\"{:,.0f}\".format(item.qty)}}\n                            <span class=\"light\">{{item.uom}}</span>\n                        </td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.rate)}}</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.amount)}}</td>\n                        <td style=\"text-align:center;\">5%</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.tax_amount)}}</td>\n                        <td style=\"text-align:right;\">{{\"{:,.2f}\".format(item.amount+item.tax_amount)}}</td>\n                    </tr>\n                {% endfor %}\n            </tbody>\n        </table>\n    </div>\n</div>\n\n<div class=\"row no-page-break\">\n    <div class=\"col-md-12\">\n        <div class=\"row\">\n            <div class=\"col-md-6 no-page-break\" style=\"width:58%;float:Left; margin-top:-16px;\">\n                <div class=\"no-page-break\">\n                    Amount in Words:&nbsp;&nbsp;<span style=\"font-weight:bold;font-style:italic;font-size:11px;\">{{doc.in_words}}</span>\n                    <br><br>\n                    <p><span style=\"font-size:11px;\"><b>Acknoweledgement Details &nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;</b></span></p><br>\n                    <p><span style=\"font-size:11px;\"><b>Document Inside &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; Certficates (&nbsp;&nbsp;) / Cards (&nbsp;&nbsp;) </b></span></p><br>\n                    <p><span style=\"font-size:11px;\">Name of the Receiver &nbsp;&nbsp;&nbsp;:&nbsp; _______________________</span></p><br>\n                    <p><span style=\"font-size:11px;\">Date of Receiving &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; _______________________</span></p><br>\n                    <p><span style=\"font-size:11px;\">Contact No. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp; _______________________</span></p>\n                </div>\n            </div>\n            <div class=\"col-md-6\" style=\"width:42%;float:right; margin-top:-40px;\">\n                <div class=\"no-page-break\">\n                    <table class=\"table table-bordered totalTable\">\n                        <tr><th style=\"width:57.5%;text-align:left;\">Sub Total</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.total)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">Discount</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.discount_amount)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">Total Amount</th>\n                            <td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.net_total)}}</td></tr>\n                        <tr><th style=\"width:57.5%;text-align:left;\">VAT @ 5%</th><td style=\"text-align:right;\">{{\"{:,.2f}\".format(doc.total_taxes_and_charges)}}</td></tr>\n                        <tr class=\"totalRow\"><th style=\"text-align:left;\"><span style=\"font-weight:700;color:black;\">Amount Including VAT</span></th>\n                            <td style=\"text-align:right;\"><b>{{doc.currency}} {{\"{:,.2f}\".format(doc.grand_total)}}</b></td></tr>\n                        <tr><th style=\"width:57%;text-align:left;\">Advance Received </th>\n                            <td style=\"text-align:right;color:red;\"> (-) {{'%0.2f'%(doc.total_advance)|float}}</td></tr>\n                        <tr class=\"totalRow\"><th style=\"text-align:left;\"><span style=\"font-weight:700;color:black;\">Balance Due</span></th>\n                            <td style=\"text-align:right;\"><b>{{doc.currency}} {{\"{:,.2f}\".format(doc.outstanding_amount)}}</b></td></tr>\n                    </table>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-7 d-flex flex-column justify-content-between\" style=\"width:60%;float:left;font-size:11px;\">\n        <div style=\"width:100%;\">\n            <br><br><br>\n            <b>Signature and Stamp &nbsp;&nbsp;: _______________________</b>\n        </div>\n    </div>\n    <div class=\"col-md-5 d-flex flex-column justify-content-between\" style=\"width:40%;float:right;font-size:11px;\">\n        <div style=\"width:100%;\">\n            <br>\n            <b>Delivered By : _______________________</b>\n            <br><br>\n            <b>Delivered On : _______________________</b>\n        </div>\n    </div>\n</div>\n\n{% endif %} {# end custom_include_invoice #}\n\n{# ===================================================== #}\n{# 2) CERTIFICATES (new format, controlled by custom_include_certificates) #}\n{# ===================================================== #}\n\n{# ===================================================== #}\n{# 2) CERTIFICATES \u2013 new layout (one per student)        #}\n{# ===================================================== #}\n{# ===================================================== #}\n{# 2) CERTIFICATES \u2013 new layout (one per student)        #}\n{# ===================================================== #}\n{# ===================================================== #}\n{# 2) CERTIFICATES \u2013 new layout (one per student)        #}\n{# ===================================================== #}\n\n{# ===================================================== #}\n{# 2) CERTIFICATES \u2013 new layout (one per student)        #}\n{# ===================================================== #}\n\n{% if doc.custom_include_certificates %}\n\n  {# page break if invoice printed above #}\n  {% if doc.custom_include_invoice %}\n    <div class=\"page-break\"></div>\n  {% endif %}\n\n  {# Linked Student Group (for Assessment Result filters) #}\n  {% set sg_name = doc.select_student_group[0].student_group if doc.select_student_group else None %}\n\n  {% for row in doc.student %}\n    {% if not loop.first %}\n      <div class=\"page-break\"></div>\n    {% endif %}\n\n    {# ---- Fetch Assessment Result (name + certificate_validity_date) for this student ---- #}\n    {% set ar = frappe.db.get_value(\n      \"Assessment Result\",\n      {\n        \"student\": row.student,\n        \"student_group\": sg_name\n      },\n      [\"name\", \"certificate_validity_date\"],\n      as_dict=True\n    ) %}\n\n    {% set ar_name = ar.name if ar else None %}\n    {% set ar_validity = ar.certificate_validity_date if ar else None %}\n\n    <div style=\"position: relative; width: 100%; font-family: Arial, sans-serif;\">\n\n      <!-- Top Logo -->\n      <div style=\"text-align: left; margin-bottom: 20px;\">\n        <img src=\"/files/Screenshot from 2025-07-15 08-45-36.png\"\n             width=\"80\" height=\"80\" alt=\"Logo\">\n      </div>\n\n      <br/><br/><br/>\n\n      <!-- Header Logo & Titles -->\n      <div style=\"text-align: center; margin-bottom: 20px;\">\n        <h1 style=\"color: blue; margin: 5px 0; font-size:30px\">\n          NUMERO UNO TRAINING &amp; CONSULTING LLC\n        </h1>\n        <h3 style=\"margin: 0;\">CERTIFICATE OF COMPLETION / ATTENDANCE</h3>\n      </div>\n\n      <br/>\n\n      <!-- Student Name & Main Text -->\n      <div style=\"text-align: center; margin: 20px 0;\">\n        <h4 style=\"margin-bottom: 10px;\"><strong>This is to certify that</strong></h4>\n        <h2 style=\"margin: 0 0 20px;\">{{ row.student_name }}</h2>\n\n        <br/>\n\n        <p style=\"margin: 0 0 10px;\">\n          <strong>\n            attended and has been assessed against, and met the outcomes of,\n            the following OPITO-approved standard:\n          </strong>\n        </p>\n\n        {# Program (optional) #}\n        {% if doc.program %}\n          {{ doc.program }}\n        {% endif %}\n\n        <br/>\n\n        {# Course name (agar course field SI pe nahi hai to yahan se hata bhi sakte ho) #}\n        {% if doc.course %}\n          {{ doc.course }}\n        {% endif %}\n\n        {# Formatted Award Date (from custom_certificate_validity_date on SI) #}\n        {% if doc.custom_certificate_validity_date %}\n          {% set dt = frappe.utils.get_datetime(doc.custom_certificate_validity_date) %}\n          {% if dt %}\n            {% set day = dt.day %}\n            {% set suffix = (\n               'th' if 11 <= day <= 13 else\n               'st' if day % 10 == 1 else\n               'nd' if day % 10 == 2 else\n               'rd' if day % 10 == 3 else\n               'th'\n            ) %}\n            <p style=\"margin-top: 10px; font-style: italic;\">\n              Awarded on {{ day }}{{ suffix }} {{ dt.strftime(\"%B %Y\") }}\n            </p>\n          {% endif %}\n        {% endif %}\n      </div>\n\n      <!-- Course / Expiry / Certificate Details -->\n      <table style=\"width: 60%; margin: 0 auto 30px; font-size: 12px;\">\n\n        {# ---------------- COURSE DATE ---------------- #}\n        <tr>\n          <td><strong>Course Date</strong></td>\n          <td>:</td>\n          <td style=\"border-bottom: 1px dotted #000;\">\n\n            {% set start = doc.course_start_date\n                           or (sg_name and frappe.db.get_value(\"Student Group\", sg_name, \"from_date\")) %}\n            {% set end   = doc.course_end_date\n                           or (sg_name and frappe.db.get_value(\"Student Group\", sg_name, \"to_date\")) %}\n\n            {% if start and end %}\n              {% if start != end %}\n                {{ frappe.utils.formatdate(start, \"dd-MM-yyyy\") }}\n                to\n                {{ frappe.utils.formatdate(end, \"dd-MM-yyyy\") }}\n              {% else %}\n                {{ frappe.utils.formatdate(start, \"dd-MM-yyyy\") }}\n              {% endif %}\n            {% else %}\n              N/A\n            {% endif %}\n          </td>\n        </tr>\n\n        {# ---------------- EXPIRY DATE (from Assessment Result.certificate_validity_date) ---------------- #}\n        <tr>\n          <td><strong>Expiry Date</strong></td>\n          <td>:</td>\n          <td style=\"border-bottom: 1px dotted #000;\">\n            {% if ar_validity %}\n              {{ frappe.utils.formatdate(ar_validity, \"dd-MM-yyyy\") }}\n            {% else %}\n              N/A\n            {% endif %}\n          </td>\n        </tr>\n\n        {# ---------------- CERTIFICATE NO (Assessment Result name) ---------------- #}\n        <tr>\n          <td><strong>Certificate No</strong></td>\n          <td>:</td>\n          <td style=\"border-bottom: 1px dotted #000;\">\n            {% if ar_name %}\n              {{ ar_name }}\n            {% else %}\n              {{ doc.name }}-{{ row.idx }}\n            {% endif %}\n          </td>\n        </tr>\n      </table>\n\n      <!-- full-width 1\u00d73 table -->\n      <table style=\"width:100%; margin:40px 0; border-collapse:collapse;\">\n        <tr>\n          <!-- Instructor cell -->\n          <td style=\"width:33%; text-align:center; vertical-align:middle;\">\n            {% set instructor_name = frappe.db.get_value(\n                 \"Student Group Instructor\",\n                 {\"parent\": sg_name},\n                 \"instructor_name\"\n            ) %}\n            {% if instructor_name %}\n              <img\n                src=\"/files/Screenshot from 2025-07-15 08-49-17.png\"\n                width=\"120\" height=\"80\"\n                alt=\"Instructor Signature\"\n                style=\"display:block; margin:0 auto 8px;\"\n              />\n              {{ instructor_name }}\n            {% endif %}\n            <br/>\n            Instructor\n          </td>\n\n          <!-- QR code cell -->\n          <td style=\"width:33%; text-align:center; vertical-align:middle;\">\n            {% set pf   = \"Assessment Certificate\" %}\n            {% set lh   = \"0\" %}\n            {% set lang = frappe.local.lang or \"en\" %}\n            {% set base = frappe.utils.get_url() %}\n            {% set print_url =\n                 base ~ \"/printview\"\n                 ~ \"?doctype=\"  ~ doc.doctype|urlencode\n                 ~ \"&name=\"     ~ doc.name|urlencode\n                 ~ \"&format=\"   ~ pf|urlencode\n                 ~ \"&no_letterhead=0\"\n                 ~ \"&letterhead=\"  ~ lh|urlencode\n                 ~ \"&settings=%7B%7D\"\n                 ~ \"&_lang=\"    ~ lang|urlencode\n            %}\n            <img\n              src=\"https://barcode.tec-it.com/barcode.ashx?data={{ print_url|urlencode }}&code=QRCode&dpi=150\"\n              width=\"120\" height=\"120\"\n              alt=\"QR code for {{ doc.name }}\"\n            />\n            <p>ACTVET License No. <br/>0716/2013</p>\n          </td>\n\n          <!-- Academic Director cell -->\n          <td style=\"width:33%; text-align:center; vertical-align:middle;\">\n            <img\n              src=\"/files/Screenshot from 2025-07-15 08-49-17.png\"\n              width=\"120\" height=\"80\"\n              alt=\"Director Signature\"\n              style=\"display:block; margin:0 auto 8px;\"\n            />\n            Academic Director\n          </td>\n        </tr>\n      </table>\n\n      <!-- Footer Image -->\n      <div style=\"text-align: center;\">\n        <img src=\"/files/Screenshot from 2025-07-15 08-47-53.png\"\n             style=\"width: 100%;\" alt=\"Footer\">\n      </div>\n    </div>\n  {% endfor %}\n\n{% endif %}\n\n\n{# ===================================================== #}\n{# 3) ATTENDANCE SHEET (new Student Group-style, controlled by custom_include_attendance) #}\n{# ===================================================== #}\n\n{# ===================================================== #}\n{# 3) ATTENDANCE SHEET (Student Group style)            #}\n{# ===================================================== #}\n{# ===================================================== #}\n{# 3) ATTENDANCE SHEET - from Student Group format       #}\n{#     but driven from Sales Invoice                     #}\n{# ===================================================== #}\n{# ===================================================== #}\n{# 3) ATTENDANCE SHEET - from Student Group format       #}\n{#     but driven from Sales Invoice                     #}\n{# ===================================================== #}\n{# ===================================================== #}\n{# 3) ATTENDANCE SHEET \u2013 Student Group format via SI     #}\n{# ===================================================== #}\n\n{% if doc.custom_include_attendance %}\n\n  {# page break if invoice or certificate printed above #}\n  {% if doc.custom_include_invoice or doc.custom_include_certificates %}\n    <div class=\"page-break\"></div>\n  {% endif %}\n\n  {%- from \"templates/print_formats/standard_macros.html\" import add_header -%}\n  {% set g = {} %}\n\n  {# --- Get linked Student Group (first selected) --- #}\n  {% if doc.select_student_group and doc.select_student_group[0].student_group %}\n    {% set sg_name = doc.select_student_group[0].student_group %}\n    {% set sg_doc  = frappe.get_doc(\"Student Group\", sg_name) %}\n  {% else %}\n    {% set sg_doc = None %}\n  {% endif %}\n\n  <div>\n    {% if sg_doc and sg_doc.students %}\n\n      {# 1) Customer list \u2013 from Sales Invoice (or fallback) #}\n      {% set selected_customer = doc.custom_customer or doc.customer %}\n\n      {% set customers = [] %}\n      {% if selected_customer %}\n        {% set customers = [selected_customer] %}\n      {% else %}\n        {% for i in sg_doc.students %}\n          {% if i.customer_name and i.customer_name not in customers %}\n            {% set _ = customers.append(i.customer_name) %}\n          {% endif %}\n        {% endfor %}\n      {% endif %}\n\n      {# 2) Date list \u2013 from Student Group date range #}\n      {%- set start = frappe.utils.getdate(sg_doc.custom_from_date or sg_doc.from_date) -%}\n      {%- set end   = frappe.utils.getdate(sg_doc.custom_to_date   or sg_doc.to_date)   -%}\n      {%- set total_days = frappe.utils.date_diff(end, start) + 1 -%}\n      {%- set dates = [] -%}\n      {%- for i in range(total_days) -%}\n        {%- set dt = frappe.utils.add_days(start, i) -%}\n        {%- set _  = dates.append(dt) -%}\n      {%- endfor -%}\n\n      {# 3) Loop: Customer -> PO -> Students #}\n      {% for customer in customers %}\n        {% set title = customer if customer else \"&nbsp;\" %}\n\n        {# unique PO list per customer, from Student master #}\n        {% set po_list = [] %}\n        {% for k in sg_doc.students if k.customer_name == customer %}\n          {% set student_po = frappe.db.get_value(\"Student\", k.student, \"custom_customer_purchase_order\") %}\n          {% if student_po and student_po not in po_list %}\n            {% set _ = po_list.append(student_po) %}\n          {% endif %}\n        {% endfor %}\n\n        {% if po_list|length == 0 %}\n          {% set po_list = [None] %}\n        {% endif %}\n\n        {% for po in po_list %}\n\n          {# whether we need \"Secondary Company\" column #}\n          {% set secondary_hits = [] %}\n          {% for k in sg_doc.students if k.customer_name == customer %}\n            {% set student_po = frappe.db.get_value(\"Student\", k.student, \"custom_customer_purchase_order\") %}\n            {% if student_po == po %}\n              {% set sc = frappe.db.get_value(\"Student\", k.student, \"custom_secondary_customer\") %}\n              {% if sc %}\n                {% set _ = secondary_hits.append(1) %}\n              {% endif %}\n            {% endif %}\n          {% endfor %}\n          {% set show_secondary = secondary_hits|length > 0 %}\n\n          <div style=\"page-break-before: always;\">\n\n            {# --- PAGE HEADER --- #}\n            {% set letter_head = frappe.get_doc(\"Letter Head\", \"Letter Head New\") %}\n            {% if letter_head %}\n              <div class=\"letter-head\">{{ letter_head.content }}</div>\n            {% endif %}\n            <div class=\"row\" style=\"text-align:center; margin-top:0;\">\n              <h2><b><u>ATTENDENCE SHEET</u></b></h2>\n            </div>\n\n            <div style=\"margin-top:2%; display:flex; gap:24px;\">\n              <div class=\"col-1\">\n                <p><b>Sheet No :</b> {{ doc.name }}</p>\n                <p><b>Date :</b> {{ frappe.utils.formatdate(doc.creation) }}</p>\n                <p><b>Course Start Date :</b>\n                  {{ frappe.utils.formatdate(sg_doc.from_date) if sg_doc.from_date else \"\" }}\n                </p>\n                <p><b>Course End Date :</b>\n                  {{ frappe.utils.formatdate(sg_doc.to_date) if sg_doc.to_date else \"\" }}\n                </p>\n              </div>\n              <div class=\"col-2\">\n                <p><b>Confirmation Type :</b>\n                  {{ po or doc.po_no or \"\" }}\n                </p>\n                <p><b>Training :</b> {{ sg_doc.course or \"\" }}</p>\n                <p><b>Course Location :</b> {{ sg_doc.custom_course_location_name or \"\" }}</p>\n              </div>\n            </div>\n\n            <table width=\"100%\" style=\"margin-top: 12px; border: none !important; border-collapse: collapse;\">\n              <tr style=\"border: none !important;\">\n                <td style=\"\n                    text-align: left;\n                    font-size: 15px;\n                    font-weight: bold;\n                    padding: 0;\n                    border: none !important;\n                \">\n                  {{ title }}\n                  {% if po %}\n                    - PO: {{ po }}\n                  {% endif %}\n                </td>\n              </tr>\n            </table>\n\n            {# --- MAIN TABLE --- #}\n            <table width=\"100%\" style=\"border:1px solid #000; border-collapse:collapse; margin-top:5%;\">\n              <tr>\n                <th style=\"border:1px solid #000; padding:4px;\">S.No</th>\n                <th style=\"border:1px solid #000; padding:4px;\">Name Of the Delegate</th>\n                <th style=\"border:1px solid #000; padding:4px;\">PO No</th>\n\n                {% if show_secondary %}\n                  <th style=\"border:1px solid #000; padding:4px;\">Secondary Company</th>\n                {% endif %}\n\n                <th style=\"border:1px solid #000; padding:4px;\">Nationality</th>\n                <th style=\"border:1px solid #000; padding:4px;\">DOB</th>\n\n                {% for d in dates %}\n                  <th style=\"border:1px solid #000; padding:4px; white-space:nowrap;\">\n                    {{ frappe.utils.formatdate(d, \"MMM dd\") }}\n                  </th>\n                {% endfor %}\n\n                <th style=\"border:1px solid #000; padding:4px;\">Result</th>\n                <th style=\"border:1px solid #000; padding:4px;\">Card Received</th>\n              </tr>\n\n              {% set serial = [] %}\n\n              {% for k in sg_doc.students if k.customer_name == customer %}\n                {% set student_po = frappe.db.get_value(\"Student\", k.student, \"custom_customer_purchase_order\") %}\n\n                {% if (po and student_po == po) or (not po and not student_po) %}\n                  {% set _ = serial.append(1) %}\n                  <tr>\n                    <td style=\"border:1px solid #000; padding:4px; text-align:center;\">\n                      {{ serial|length }}\n                    </td>\n                    <td style=\"border:1px solid #000; padding:4px;\">\n                      {{ k.student_name }}\n                    </td>\n                    <td style=\"border:1px solid #000; padding:4px;\">\n                      {{ student_po or \"\" }}\n                    </td>\n\n                    {% if show_secondary %}\n                      {% set secondary_customer = frappe.db.get_value(\"Student\", k.student, \"custom_secondary_customer\") %}\n                      <td style=\"border:1px solid #000; padding:4px;\">\n                        {{ secondary_customer or \"\" }}\n                      </td>\n                    {% endif %}\n\n                    {% set nationality = frappe.db.get_value(\"Student\", k.student, \"nationality\") %}\n                    <td style=\"border:1px solid #000; padding:4px;\">\n                      {{ nationality or \"\" }}\n                    </td>\n\n                    {% set dob = frappe.db.get_value(\"Student\", k.student, \"date_of_birth\") %}\n                    <td style=\"border:1px solid #000; padding:4px;\">\n                      {{ frappe.utils.formatdate(dob) if dob else \"\" }}\n                    </td>\n\n                    {# attendance signatures per day #}\n                    {% for d in dates %}\n                      {% set att_name = frappe.db.get_value(\n                        \"Student Attendance\",\n                        {\"date\": d, \"student_group\": sg_doc.name, \"student\": k.student, \"docstatus\": 1},\n                        \"name\"\n                      ) %}\n                      {% set sig1 = None %}\n                      {% set sig2 = None %}\n                      {% if att_name %}\n                        {% set sig1 = frappe.db.get_value(\"Student Attendance\", att_name, \"custom_student_signature1\") %}\n                        {% set sig2 = frappe.db.get_value(\"Student Attendance\", att_name, \"custom_student_signature\") %}\n                      {% endif %}\n                      <td style=\"border:1px solid #000; padding:4px; text-align:center;\">\n                        {% if sig1 %}\n                          <img src=\"{{ sig1 }}\" style=\"width:60px; height:25px; object-fit:contain;\" />\n                        {% elif sig2 %}\n                          <img src=\"{{ sig2 }}\" style=\"width:60px; height:25px; object-fit:contain;\" />\n                        {% endif %}\n                      </td>\n                    {% endfor %}\n\n                    <td style=\"border:1px solid #000; padding:4px;\"></td>\n\n                    {# Card Received: Student Card signature #}\n                    {% set sig = None %}\n                    {% set s_card_name = frappe.db.get_value(\n                      \"Student Card\",\n                      {\"student_group\": sg_doc.name, \"student\": k.student, \"docstatus\": 1},\n                      \"name\"\n                    ) %}\n                    {% if s_card_name %}\n                      {% set sig = frappe.db.get_value(\"Student Card\", s_card_name, \"student_signature\") %}\n                    {% endif %}\n                    <td style=\"border:1px solid #000; padding:4px;\">\n                      {% if sig %}\n                        <img style=\"width:300px; height:70px;\" src=\"{{ sig }}\" />\n                      {% endif %}\n                    </td>\n                  </tr>\n                {% endif %}\n              {% endfor %}\n            </table>\n\n            <div style=\"width:100%; overflow:auto;\">\n              <div style=\"float:left; margin-top:5%; width:50%;\">\n                {% if sg_doc.instructors %}\n                  {% for i in sg_doc.instructors %}\n                    <p>INSTRUCTOR'S NAME: <b>{{ i.instructor_name }}</b></p>\n                  {% endfor %}\n                {% endif %}\n                <p>Date:</p>\n              </div>\n              <div style=\"float:right; margin-top:5%; width:30%;\">\n                <p>SIGNATURE:</p>\n              </div>\n            </div>\n          </div>\n        {% endfor %}\n      {% endfor %}\n\n    {% endif %}\n  </div>\n\n  <footer class=\"print-footer\">\n    <div class=\"col-md-12\">\n      <div class=\"row\">\n        <div id=\"footer-html\" class=\"hidden-pdf\">\n          <div class=\"letter-head-footer\">\n            <table width=\"100%\">\n              <tr>\n                <th>\n                  Po Box 132435, ICAD, Behind Dalma Mall Block B Mussaffah, Abu Dhabi, U.A.E\n                </th>\n              </tr>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  </footer>\n\n{% endif %}\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2026-01-30 10:27:56.566065",
 "modified_by": "Administrator",
 "module": "Numerouno",
 "name": "Invoice, Certificate, Attendance, Card",
 "owner": "Administrator",
 "page_number": "Hide",
 "pdf_generator": "chrome",
 "print_designer": 0,
 "print_designer_template_app": "print_designer",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_for": "DocType",
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}