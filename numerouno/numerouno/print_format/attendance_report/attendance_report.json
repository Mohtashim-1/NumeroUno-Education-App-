{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-04-29 23:45:21.665844",
 "css": ".col-1{\n      width: 50%; float: left; font-weight: bold;\n      }\n.col-2{\nwidth: 50%; float: right; font-weight: bold;}\t\np{ font-size: 12px; }\n\ntable, th, td {\n  border: 1px solid black;\n}\n  ",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Student Group",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{%- from \"templates/print_formats/standard_macros.html\" import add_header -%}\r\n<div class=\"row\">\r\n    <div class=\"col-md-12\" style=\"display:flex; width:100%;margin-top:-20px; margin-bottom:-20px;\">\r\n        <div {% if print_settings.repeat_header_footer %} id=\"header-html\" class=\"hidden-pdf\">\r\n            {% endif %}\r\n\r\n            {% set letter_head = frappe.get_doc(\"Letter Head\", \"Letter Head New\") %}\r\n\r\n            {% if letter_head %}\r\n                <div class=\"letter-head\"> {{ letter_head.content }} </div>\r\n\r\n                <div class=\"row\" style=\"text-align: CENTER ;margin-top:0px;\">\r\n                    <h2><b><u>ATTENDANCE SHEET</u></b></h2>\r\n                </div>\r\n\r\n                <div style=\"margin-top:2%;\">\r\n                    <div class=\"col-1\">\r\n                        <p><b>Sheet No : {{ doc.name }}</b></p>\r\n                        <p>Date : {{ frappe.utils.formatdate(doc.creation) }}</p>\r\n                        <p>Course Start Date : {{ frappe.utils.formatdate(doc.from_date) }}</p>\r\n                        <p>Course End Date : {{ frappe.utils.formatdate(doc.to_date) }}</p>\r\n                    </div>\r\n                    <div class=\"col-2\">\r\n                        <p>Confirmation Type : {{ doc.custom_confirmation_type }}</p>\r\n                        <p>Training : {{ doc.course }}</p>\r\n                        <p>Course Location : {{ doc.custom_course_location_name }}</p>\r\n                    </div>\r\n                </div>\r\n            {% endif %}\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div>\r\n    {% if doc.students %}\r\n        {% set unique_items = [] %}\r\n        {% for i in doc.students %}\r\n            {% if i.customer_name not in unique_items %}\r\n                {% set _ = unique_items.append(i.customer_name) %}\r\n            {% endif %}\r\n        {% endfor %}\r\n\r\n        {% for item in unique_items %}\r\n            {% set title = item or \"&nbsp;\" %}\r\n            <div style=\"page-break-before: always;\">\r\n                <h3 style=\"float:left;margin-top:12%\">{{ title }}</h3>\r\n\r\n                {# Build date list with actual date objects #}\r\n                {%- set start = frappe.utils.getdate(doc.custom_from_date) -%}\r\n                {%- set end = frappe.utils.getdate(doc.custom_to_date) -%}\r\n                {%- set date_list = [] -%}\r\n                {%- for i in range((end - start).days + 1) %}\r\n                    {%- set new_date = frappe.utils.add_days(start, i) %}\r\n                    {%- set _ = date_list.append(new_date) %}\r\n                {%- endfor %}\r\n\r\n                <table width=\"100%\" style=\"border:1px solid black;margin-top:5%\">\r\n                    <tr>\r\n                        <th width=\"10%\">S.No</th>\r\n                        <th>Name Of the Delegate</th>\r\n                        <th>Contact No.</th>\r\n                        <th>Nationality</th>\r\n                        <th>DOB</th>\r\n\r\n                        {% for d in date_list %}\r\n                            <!--<th style=\"width:10%\">Day {{ frappe.utils.formatdate(d, \"d\") }}</th>-->\r\n\r\n                             <th style=\"width:10%\">Day {{ loop.index }}</th>\r\n\r\n                        {% endfor %}\r\n                        <th>Result</th>\r\n                        <th>Card Received</th>\r\n                    </tr>\r\n\r\n                    {% set count = [] %}\r\n                    {% for k in doc.students %}\r\n                        {% if k.customer_name == item %}\r\n                            {% set _ = count.append(1) %}\r\n                            <tr>\r\n                                <td>{{ count | length }}</td>\r\n                                <td>{{ k.student_name }}</td>\r\n\r\n                                {% set mob = frappe.db.get_value(\"Student\", k.student, \"student_mobile_number\") %}\r\n                                <td>{{ mob or '' }}</td>\r\n\r\n                                {% set nationality = frappe.db.get_value(\"Student\", k.student, \"nationality\") %}\r\n                                <td>{{ nationality or '' }}</td>\r\n\r\n                                {% set dob = frappe.db.get_value(\"Student\", k.student, \"date_of_birth\") %}\r\n                                <td>{{ frappe.utils.formatdate(dob) if dob else '' }}</td>\r\n\r\n                           {% for d in date_list %}\r\n    {% set att_data = frappe.db.get_value(\r\n        \"Student Attendance\",\r\n        {\r\n            \"date\": frappe.utils.formatdate(d, \"yyyy-MM-dd\"),\r\n            \"student_group\": doc.name,\r\n            \"student\": k.student,\r\n            \"docstatus\": 1\r\n        },\r\n        [\"status\", \"custom_student_signature\"]\r\n    ) %}\r\n    <td style=\"text-align:center; vertical-align:middle;\">\r\n        {% if att_data %}\r\n            {% set status = att_data[0] %}\r\n            {% set sig = att_data[1] %}\r\n            {% if status == \"Present\" and sig %}\r\n                <img src=\"{{ sig }}\"\r\n                     style=\"max-width: 100px; max-height: 40px; object-fit: contain; display: inline-block;\" \r\n                     alt=\"Signature\" />\r\n            {% else %}\r\n                A\r\n            {% endif %}\r\n        {% else %}\r\n            A\r\n        {% endif %}\r\n    </td>\r\n{% endfor %}\r\n\r\n                                <td></td>\r\n\r\n                                {# Student Card Signature #}\r\n                                {% set s_card_name = frappe.db.get_value(\"Student Card\", {\r\n                                    \"student_group\": doc.name,\r\n                                    \"student\": k.student,\r\n                                    \"docstatus\": 1\r\n                                }) %}\r\n                                {% if s_card_name %}\r\n                                    {% set s_card = frappe.get_doc(\"Student Card\", s_card_name) %}\r\n                                {% else %}\r\n                                    {% set s_card = None %}\r\n                                {% endif %}\r\n\r\n                                <td>\r\n                                    {% if s_card and s_card.student_signature %}\r\n                                        <img src=\"{{ s_card.student_signature }}\"\r\n                     style=\"max-width: 100px; max-height: 40px; object-fit: contain; display: inline-block;\" \r\n                     alt=\"Signature\" />\r\n                                    {% else %}\r\n                                        No Signature\r\n                                    {% endif %}\r\n                                </td>\r\n                            </tr>\r\n                        {% endif %}\r\n                    {% endfor %}\r\n                </table>\r\n\r\n                <div style=\"width:100%;\">\r\n                    <div style=\"float:left; margin-top:5%; width:50%;\">\r\n                        {% if doc.instructors %}\r\n                            {% for i in doc.instructors %}\r\n                                <p>INSTRUCTOR'S NAME: <b>{{ i.instructor_name }}</b></p>\r\n                            {% endfor %}\r\n                        {% endif %}\r\n                        <p>Date:</p>\r\n                    </div>\r\n                    <div style=\"float:right; margin-top:5%; width:30%;\">\r\n                        <p>SIGNATURE:</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        {% endfor %}\r\n    {% endif %}\r\n</div>\r\n\r\n<footer class=\"print-footer\">\r\n    <div class=\"col-md-12\">\r\n        <div class=\"row\">\r\n            <div id=\"footer-html\" class=\"hidden-pdf\">\r\n                <div class=\"letter-head-footer\">\r\n                    <table width=\"100%\">\r\n                        <tr>\r\n                            <th>Po Box 132435, ICAD, Behind Dalma Mall Block B Mussaffah, Abu Dhabi, U.A.E</th>\r\n                        </tr>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</footer>\r\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-04-30 11:46:54.592702",
 "modified_by": "Administrator",
 "module": "Numerouno",
 "name": "Attendance Report",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}