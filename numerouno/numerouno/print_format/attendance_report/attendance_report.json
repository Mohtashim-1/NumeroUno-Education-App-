{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-04-29 23:45:21.665844",
 "css": ".col-1{\n      width: 50%; float: left; font-weight: bold;\n      }\n.col-2{\nwidth: 50%; float: right; font-weight: bold;}\t\np{ font-size: 12px; }\n\ntable, th, td {\n  border: 1px solid black;\n}\n  ",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Student Group",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{%- from \"templates/print_formats/standard_macros.html\" import add_header -%}\n<div class=\"row\">\n    <div class=\"col-md-12\" style=\"display:flex; width:100%;margin-top:-20px; margin-bottom:-20px;\">\n        <div {% if print_settings.repeat_header_footer %} id=\"header-html\" class=\"hidden-pdf\">\n            {% endif %}\n\n            {% set letter_head=frappe.get_doc(\"Letter Head\",\"Letter Head New\") %}\n\n            {% if letter_head %}\n            <div class=\"letter-head\"> {{ letter_head.content }} </div>\n            \n            <div class=\"row\" style=\"text-align: CENTER ;margin-top:0px;\">\n                <h2><b><u>ATTENDENCE SHEET</u></b></h2>\n            </div>\n            \n            <div style=\"margin-top:2%;\">\n                <div class=\"col-1\">\n                    <p><b>Sheet No : {{doc.name}}</b></p>\n                    <p>Date : {{frappe.utils.formatdate(doc.creation)}}</p>\n                    <p>Course Start Date : {{ frappe.utils.formatdate(doc.from_date) }}</p>\n                    <p>Course End Date : {{ frappe.utils.formatdate(doc.to_date) }}</p>\n\n                </div>\n                <div class=\"col-2\">\n                    <p>Confirmation Type : {{doc.custom_confirmation_type}}</p>\n                    <p>Training : {{doc.course}}</p>\n                    <p>Course Location : {{doc.custom_course_location_name}}</p>\n\n\n                </div>\n            </div>\n            {% endif -%}\n        </div>\n    </div>\n</div>\n\n\n<!--<div>-->\n<!--        {% set unique_items = [] %}-->\n<!--        {% for i in doc.students %}-->\n\n<!--        {% if i.customer_name not in unique_items %}-->\n\n<!--        {% set unique_items = unique_items.append(i.customer_name) %}-->\n<!--       {% endif %}-->\n<!--       {% endfor %}-->\n\n<!--</div>-->\n\n<!--<br>-->\n\n<!--<div>-->\n<!--      {% set unique_items = [] %}-->\n<!--        {% for i in doc.students %}-->\n\n<!--        {% if i.customer_name not in unique_items %}-->\n\n<!--        {% set unique_items = unique_items.append(i.customer_name) %}-->\n<!--       {% endif %}-->\n<!--       {% endfor %}-->\n<!--    {% for item in unique_items %}-->\n\n<!--    <table style=\"border:1px solid black; page-break-before: always;\">-->\n<!--        <tr>-->\n<!--            <th><h1 >{{item}}</h1></th>-->\n<!--        </tr>-->\n<!--        {% for k in doc.students %}-->\n<!--        {% if k.customer_name == item %}-->\n<!--       <tr>-->\n<!--           <td>{{k.customer_name}}</td>-->\n<!--       </tr>-->\n<!--       {% endif %}-->\n<!--       {% endfor %}-->\n<!--    </table>-->\n\n<!--    {% endfor %}-->\n<!--</div>-->\n<div>\n    {% if doc.students %}\n    {% set unique_items = [] %}\n    {% for i in doc.students %}\n\n    {% if i.customer_name not in unique_items %}\n\n    {% set unique_items = unique_items.append(i.customer_name) %}\n    {% endif %}\n    {% endfor %}\n    {% for item in unique_items %}\n    {% set title = \"&nbsp;\" %}\n    {% if item %}\n        {% set title = item %}\n    {% endif %}\n    <div style=\"page-break-before: always;\">\n        <h3 style=\"float:left;margin-top:12%\">{{title}}</h3>\n        <table width=\"100%\" style=\"border:1px solid black;margin-top:5%\">\n    <tr>\n        <th>S.No</th>\n        <th>Name Of the Delegate</th>\n        <th>Contact No.</th>\n        <th>Nationality</th>\n        <th>DOB</th>\n\n        {%- set start = frappe.utils.getdate(doc.custom_from_date) -%}\n        {%- set end = frappe.utils.getdate(doc.custom_to_date) -%}\n        {%- set date_list = [] -%}\n\n        {# Generate list of dates from custom_from_date to custom_to_date #}\n        {%- for i in range((end - start).days + 1) %}\n            {%- set new_date = frappe.utils.add_days(start, i) %}\n            {%- set _ = date_list.append(frappe.utils.formatdate(new_date, \"d\").lower()) %}\n        {%- endfor %}\n\n        {# Render table headers for each date #}\n        {% for d in date_list %}\n            <th>Day {{ d }}</th>\n        {% endfor %}\n\n        <th>Result</th>\n        <th>Card Received</th>\n    </tr>\n\n    {% set count = [] %}\n    {% for k in doc.students %}\n        {% if k.customer_name == item %}\n            {% set m = count.append(1) %}\n            <tr>\n                <td>{{ count|length }}</td>\n                <td>{{ k.student_name }}</td>\n\n                {# Contact No. #}\n                {% set mob = frappe.db.get_value(\"Student\", k.student, \"student_mobile_number\") %}\n                <td>{{ mob if mob else '' }}</td>\n\n                {# Nationality #}\n                {% set nationality = frappe.db.get_value(\"Student\", k.student, \"nationality\") %}\n                <td>{{ nationality if nationality else '' }}</td>\n\n                {# DOB #}\n                {% set dob = frappe.db.get_value(\"Student\", k.student, \"date_of_birth\") %}\n                <td>{{ frappe.utils.formatdate(dob) if dob else '' }}</td>\n\n                {# Empty cells for each date in range - you can replace this with actual attendance data #}\n               {% for d in date_list %}\n    {% set att_date = frappe.utils.formatdate(d, \"yyyy-mm-dd\") %}\n    {% set status = frappe.db.get_value(\n        \"Student Attendance\",\n        {\n            \"date\": att_date,\n            \"student_group\": doc.name,\n            \"student\": k.student,\n            \"docstatus\": 1\n        },\n        \"status\"\n    ) %}\n    <td>{{ \"P\" if status == \"Present\" else \"A\" }}</td>\n{% endfor %}\n\n\n\n                <td></td>\n                \n               {% set s_card = frappe.get_doc(\"Student Card\", {\n    \"student_group\": doc.name,\n    \"student\": k.student,\n    \"docstatus\": 1\n}) %}\n<td>\n    {% if s_card and s_card.student_signature %}\n     <img style=\"width: 300px !important; height: 70px !important; display: block;\" src=\"{{ s_card.student_signature }}\" alt=\"Signature\" />\n    {% else %}\n        No Signature\n    {% endif %}\n</td>\n\n\n            </tr>\n        {% endif %}\n    {% endfor %}\n</table>\n\n        <div style=\"width:100%;\">\n            <div style=\"float:left; margin-top:5%; width:50%;\">\n                {% if doc.instructors %}\n                {% for i in doc.instructors %}\n                <p style=\"\">INSTRUCTOR'S NAME:<b> {{i.instructor_name}}</b></p>\n                {% endfor %}\n                {% endif %}\n                <p>Date:</p>\n            </div>\n            <div style=\"float:right; margin-top:5%; width:30%;\">\n                <p>SIGNATURE:</p>\n            </div>\n        </div>\n    </div>\n    {% endfor %}\n    {% endif %}\n</div>\n\n\n<footer class=\"print-footer\">\n    <div class=\"col-md-12\">\n        <div class=\"row\">\n            <div id=\"footer-html\" class=\"hidden-pdf\">\n                <div class=\"letter-head-footer\">\n                    <div class=\"letter-head-footer\" style=\"\">\n                        <table width=100%>\n                            <tr>\n                                <th>Po Box 132435, ICAD , Behind Dalma Mall Block B Mussaffah, Abu Dhabi , U.A.E</th>\n                            </tr>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n</footer>",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-04-29 23:45:25.234776",
 "modified_by": "Administrator",
 "module": "Numerouno",
 "name": "Attendance Report",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}